/**
 * @preserve Basic Primitives orgDiagram v1.0.33
 *
 * (c) Adeltech Productions Inc
 *
 * License: http://www.basicprimitives.com/redirectto/license.html
 *
 */
(function(){var e=function(e){var t=e.split("."),n=window,r;for(r=0;r<t.length;r+=1)n=n[t[r]]=n[t[r]]||{};return n};e("primitives.common"),e("primitives.orgdiagram"),e("primitives.text"),e("primitives.callout")})(),primitives.common.isNullOrEmpty=function(e){var t=!0,n;return e!==undefined&&e!==null&&(n=e.toString(),n.length>0&&(t=!1)),t},primitives.common.hashCode=function(e){var t=0,n,r;if(e.length>0)for(r=0;r<e.length;r+=1)n=e.charCodeAt(r),t=(t<<5)-t+n,t&=t;return t},primitives.common.attr=function(e,t){var n,r;if(e.hasOwnProperty("attrHash"))for(n in t)t.hasOwnProperty(n)&&(r=t[n],e.attrHash[n]!=r&&(e.attrHash[n]=r,e.attr(n,r)));else e.attr(t),e.attrHash=t},primitives.common.css=function(e,t){var n,r;if(e.hasOwnProperty("cssHash"))for(n in t)t.hasOwnProperty(n)&&(r=t[n],e.cssHash[n]!=r&&(e.cssHash[n]=r,e.css(n,r)));else e.css(t),e.cssHash=t},primitives.common.stopPropagation=function(e){e.stopPropagation!==undefined?e.stopPropagation():e.cancelBubble!==undefined?e.cancelBubble=!0:e.preventDefault!==undefined&&e.preventDefault()},primitives.common.indexOf=function(e,t){var n,r;for(n=0;n<e.length;n+=1){r=e[n];if(r===t)return n}return-1},primitives.common._supportsSVG=null,primitives.common.supportsSVG=function(){return primitives.common._supportsSVG===null&&(primitives.common._supportsSVG=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.0")),primitives.common._supportsSVG},primitives.common._supportsVML=null,primitives.common.supportsVML=function(){var e,t;return primitives.common._supportsVML===null&&(primitives.common._supportsVML=!1,jQuery.support.opacity||(e=document.createElement("div"),e=document.body.appendChild(e),e.innerHTML='<v:shape adj="1" />',t=e.firstChild,t.style.behavior="url(#default#VML)",primitives.common._supportsVML=t?typeof t.adj=="object":!1,e.parentNode.removeChild(e))),primitives.common._supportsVML},primitives.common._supportsCanvas=null,primitives.common.supportsCanvas=function(){return primitives.common._supportsCanvas===null&&(primitives.common._supportsCanvas=!!window.HTMLCanvasElement),primitives.common._supportsCanvas},primitives.common.createGraphics=function(e,t){var n=null,r,i,s;r=[e];for(i in primitives.common.GraphicsType)primitives.common.GraphicsType.hasOwnProperty(i)&&r.push(primitives.common.GraphicsType[i]);for(s=0;n===null&&s<r.length;s+=1)switch(r[s]){case 2:primitives.common.supportsVML()&&(n=new primitives.common.VmlGraphics(t));break;case 0:primitives.common.supportsSVG()&&(n=new primitives.common.SvgGraphics(t));break;case 1:primitives.common.supportsCanvas()&&(n=new primitives.common.CanvasGraphics(t))}return n},primitives.common.getColorHexValue=function(e){var t,n,r,i,s,o,u;if(e.substr(0,1)==="#")return e;t=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(e);if(t!==null&&t.length>0)return n=parseInt(t[2],10),r=parseInt(t[3],10),i=parseInt(t[4],10),s=(n<<16|r<<8|i).toString(16),t[1]+"000000".substr(0,6-s.length)+s;if(primitives.common.ColorHexs===undefined){primitives.common.ColorHexs={},o=0;for(u in primitives.common.Colors)primitives.common.Colors.hasOwnProperty(u)&&(primitives.common.ColorHexs[u.toUpperCase()]=primitives.common.Colors[u],o+=1)}return primitives.common.ColorHexs[e.toUpperCase()]},primitives.common.getColorName=function(e){var t,n;e=primitives.common.getColorHexValue(e);if(primitives.common.ColorNames===undefined){primitives.common.ColorNames={},t=0;for(n in primitives.common.Colors)primitives.common.Colors.hasOwnProperty(n)&&(primitives.common.ColorNames[primitives.common.Colors[n]]=n,t+=1)}return primitives.common.ColorNames[e]},primitives.common.getRed=function(e){return e.substr(0,1)==="#"&&e.length===7?parseInt(e.substr(1,2),16):null},primitives.common.getGreen=function(e){return e.substr(0,1)==="#"&&e.length===7?parseInt(e.substr(3,2),16):null},primitives.common.getBlue=function(e){return e.substr(0,1)==="#"&&e.length===7?parseInt(e.substr(5,2),16):null},primitives.common.beforeOpacity=function(e,t){var n=primitives.common,r,i,s,o;return e=n.getColorHexValue(e),r=Math.ceil((n.getRed(e)-(1-t)*255)/t),i=Math.ceil((n.getRed(e)-(1-t)*255)/t),s=Math.ceil((n.getRed(e)-(1-t)*255)/t),o=(r<<16|i<<8|s).toString(16),"#"+"000000".substr(0,6-o.length)+o},primitives.common.highestContrast=function(e,t,n){var r=t,i=primitives.common,s=e+","+t+","+n;return i.highestContrasts===undefined&&(i.highestContrasts={}),i.highestContrasts.hasOwnProperty(s)?r=i.highestContrasts[s]:(i.luminosity(t,e)<i.luminosity(n,e)&&(r=n),i.highestContrasts[s]=r),r},primitives.common.luminosity=function(e,t){var n,r=primitives.common,i=r.getColorHexValue(e),s=r.getColorHexValue(t),o=.2126*Math.pow(r.getRed(i)/255,2.2)+.7152*Math.pow(r.getRed(i)/255,2.2)+.0722*Math.pow(r.getRed(i)/255,2.2),u=.2126*Math.pow(r.getRed(s)/255,2.2)+.7152*Math.pow(r.getRed(s)/255,2.2)+.0722*Math.pow(r.getRed(s)/255,2.2);return o>u?n=(o+.05)/(u+.05):n=(u+.05)/(o+.05),n};var mouseHandled2=!1;jQuery(document).mouseup(function(){mouseHandled2=!1}),jQuery.widget("ui.mouse2",{version:"1.10.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(e){var t=this;this.element2=e,this.element2.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(e){if(!0===jQuery.data(e.target,t.widgetName+".preventClickEvent"))return jQuery.removeData(e.target,t.widgetName+".preventClickEvent"),e.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element2.unbind("."+this.widgetName),this._mouseMoveDelegate&&jQuery(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(mouseHandled2)return;this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var t=this,n=e.which===1,r=typeof this.options.cancel=="string"&&e.target.nodeName?jQuery(e.target).closest(this.options.cancel).length:!1;if(!n||r||!this._mouseCapture(e))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){t.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)){this._mouseStarted=this._mouseStart(e)!==!1;if(!this._mouseStarted)return e.preventDefault(),!0}return!0===jQuery.data(e.target,this.widgetName+".preventClickEvent")&&jQuery.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return t._mouseMove(e)},this._mouseUpDelegate=function(e){return t._mouseUp(e)},jQuery(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),mouseHandled2=!0,!0},_mouseMove:function(e){return jQuery.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button?this._mouseUp(e):this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return jQuery(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&jQuery.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),primitives.orgdiagram.AdviserPlacementType={Auto:0,Left:2,Right:3},primitives.orgdiagram.UpdateMode={Recreate:0,Refresh:1,PositonHighlight:2},primitives.text.TextOrientationType={Horizontal:0,RotateLeft:1,RotateRight:2},primitives.orgdiagram.SelectionPathMode={None:0,FullStack:1},primitives.common.SegmentType={Line:0,Move:1,QuadraticArc:2,CubicArc:3,Dot:4},primitives.common.RenderingMode={Create:0,Update:1},primitives.common.PlacementType={Auto:0,Top:1,TopRight:2,Right:3,BottomRight:4,Bottom:5,BottomLeft:6,Left:7,TopLeft:8},primitives.orgdiagram.PageFitMode={None:0,PageWidth:1,PageHeight:2,FitToPage:3},primitives.common.VerticalAlignmentType={Top:0,Middle:1,Bottom:2},primitives.orgdiagram.OrientationType={Top:0,Bottom:1,Left:2,Right:3},primitives.orgdiagram.ItemType={Regular:0,Assistant:1,Adviser:2,Invisible:3,SubAssistant:4,SubAdviser:5},primitives.common.HorizontalAlignmentType={Center:0,Left:1,Right:2},primitives.common.GraphicsType={SVG:0,Canvas:1,VML:2},primitives.common.Enabled={Auto:0,True:1,False:2},primitives.orgdiagram.ConnectorType={Squared:0,Angular:1,Curved:2},primitives.common.Colors={AliceBlue:"#f0f8ff",AntiqueWhite:"#faebd7",Aqua:"#00ffff",Aquamarine:"#7fffd4",Azure:"#f0ffff",Beige:"#f5f5dc",Bisque:"#ffe4c4",Black:"#000000",BlanchedAlmond:"#ffebcd",Blue:"#0000ff",BlueViolet:"#8a2be2",Brown:"#a52a2a",BurlyWood:"#deb887",Bronze:"#cd7f32",CadetBlue:"#5f9ea0",ChartReuse:"#7fff00",Chocolate:"#d2691e",Coral:"#ff7f50",CornflowerBlue:"#6495ed",Cornsilk:"#fff8dc",Crimson:"#dc143c",Cyan:"#00ffff",DarkBlue:"#00008b",DarkCyan:"#008b8b",DarkGoldenrod:"#b8860b",DarkGray:"#a9a9a9",DarkGreen:"#006400",DarkKhaki:"#bdb76b",DarkMagenta:"#8b008b",DarkOliveGreen:"#556b2f",Darkorange:"#ff8c00",DarkOrchid:"#9932cc",DarkRed:"#8b0000",DarkSalmon:"#e9967a",DarkSeaGreen:"#8fbc8f",DarkSlateBlue:"#483d8b",DarkSlateGray:"#2f4f4f",DarkTurquoise:"#00ced1",DarkViolet:"#9400d3",DeepPink:"#ff1493",DeepSkyBlue:"#00bfff",DimGray:"#696969",DodgerBlue:"#1e90ff",FireBrick:"#b22222",FloralWhite:"#fffaf0",ForestGreen:"#228b22",Fuchsia:"#ff00ff",Gainsboro:"#dcdcdc",GhostWhite:"#f8f8ff",Gold:"#ffd700",Goldenrod:"#daa520",Gray:"#808080",Green:"#008000",GreenYellow:"#adff2f",Honeydew:"#f0fff0",Hotpink:"#ff69b4",IndianRed:"#cd5c5c",Indigo:"#4b0082",Ivory:"#fffff0",Khaki:"#f0e68c",Lavender:"#e6e6fa",LavenderBlush:"#fff0f5",Lawngreen:"#7cfc00",Lemonchiffon:"#fffacd",LightBlue:"#add8e6",LightCoral:"#f08080",LightCyan:"#e0ffff",LightGoldenrodYellow:"#fafad2",LightGray:"#d3d3d3",LightGreen:"#90ee90",LightPink:"#ffb6c1",LightSalmon:"#ffa07a",LightSeaGreen:"#20b2aa",LightSkyBlue:"#87cefa",LightSlateGray:"#778899",LightSteelBlue:"#b0c4de",LightYellow:"#ffffe0",Lime:"#00ff00",Limegreen:"#32cd32",Linen:"#faf0e6",Magenta:"#ff00ff",Maroon:"#800000",MediumAquamarine:"#66cdaa",MediumBlue:"#0000cd",MediumOrchid:"#ba55d3",MediumPurple:"#9370d8",MediumSeaGreen:"#3cb371",MediumSlateBlue:"#7b68ee",MediumSpringGreen:"#00fa9a",MediumTurquoise:"#48d1cc",MediumVioletRed:"#c71585",MidnightBlue:"#191970",MintCream:"#f5fffa",MistyRose:"#ffe4e1",Moccasin:"#ffe4b5",NavajoWhite:"#ffdead",Navy:"#000080",Oldlace:"#fdf5e6",Olive:"#808000",Olivedrab:"#6b8e23",Orange:"#ffa500",OrangeRed:"#ff4500",Orchid:"#da70d6",PaleGoldenRod:"#eee8aa",PaleGreen:"#98fb98",PaleTurquoise:"#afeeee",PaleVioletRed:"#d87093",Papayawhip:"#ffefd5",Peachpuff:"#ffdab9",Peru:"#cd853f",Pink:"#ffc0cb",Plum:"#dda0dd",PowderBlue:"#b0e0e6",Purple:"#800080",Red:"#ff0000",RosyBrown:"#bc8f8f",RoyalBlue:"#4169e1",SaddleBrown:"#8b4513",Salmon:"#fa8072",SandyBrown:"#f4a460",SeaGreen:"#2e8b57",Seashell:"#fff5ee",Sienna:"#a0522d",Silver:"#c0c0c0",SkyBlue:"#87ceeb",SlateBlue:"#6a5acd",SlateGray:"#708090",Snow:"#fffafa",SpringGreen:"#00ff7f",SteelBlue:"#4682b4",Tan:"#d2b48c",Teal:"#008080",Thistle:"#d8bfd8",Tomato:"#ff6347",Turquoise:"#40e0d0",Violet:"#ee82ee",Wheat:"#f5deb3",White:"#ffffff",WhiteSmoke:"#f5f5f5",Yellow:"#ffff00",YellowGreen:"#9acd32"},primitives.orgdiagram.ChildrenPlacementType={Auto:0,Vertical:1,Horizontal:2,Matrix:3},primitives.orgdiagram.Layers={Connector:1,Highlight:2,Marker:3,Cursor:4,Item:5,Annotation:6},primitives.orgdiagram.Visibility={Auto:0,Normal:1,Dot:2,Line:3,Invisible:4},primitives.orgdiagram.EventArgs=function(){this.oldContext=null,this.context=null,this.parentItem=null,this.position=null,this.name=null,this.cancel=!1},primitives.common.RenderEventArgs=function(){this.element=null,this.context=null,this.templateName=null,this.renderingMode=null,this.isCursor=!1,this.isSelected=!1},primitives.common.Callout=function(e){this.m_graphics=e,this.pointerPlacement=0,this.cornerRadius="10%",this.offset=0,this.opacity=1,this.lineWidth=1,this.pointerWidth="10%",this.borderColor="#000000",this.fillColor="#d3d3d3",this.m_map=[[8,7,6],[1,null,5],[2,3,4]]},primitives.common.Callout.prototype.draw=function(e,t){t=(new primitives.common.Rect(t)).offset(this.offset);var n=new primitives.common.Point(t.x,t.y),r=new primitives.common.Point(t.right(),t.y),i=new primitives.common.Point(t.right(),t.bottom()),s=new primitives.common.Point(t.left(),t.bottom()),o=[null,null,null,null,null,null,null,null],u=[n,r,i,s],a=this.m_graphics.getPxSize(this.cornerRadius,Math.min(n.distanceTo(r),r.distanceTo(i))),f,l,c,h,p,d;e!==null&&(l=this.pointerPlacement===0?this._getPlacement(e,n,i):this.pointerPlacement,l!==null&&(o[l]=e)),f=[];for(p=0;p<u.length;p+=1)this._drawSegment(f,u[0],u[1],u[2],this.pointerWidth,a,o[1],o[2]),c=u.shift(),u.push(c),c=o.shift(),o.push(c),c=o.shift(),o.push(c);d={},this.fillColor!==null&&(d.fillColor=this.fillColor,d.opacity=this.opacity),this.borderColor!==null&&(d.borderColor=this.borderColor),d.lineWidth=this.lineWidth,h=this.m_graphics.polyline(f,d)},primitives.common.Callout.prototype._getPlacement=function(e,t,n){var r=null,i=null;return e.x<t.x?r=0:e.x>n.x?r=2:r=1,e.y<t.y?i=0:e.y>n.y?i=2:i=1,this.m_map[r][i]},primitives.common.Callout.prototype._drawSegment=function(e,t,n,r,i,s,o,u){var a=this._offsetPoint(t,n,s),f=this._offsetPoint(n,t,s),l=this._offsetPoint(n,r,s),c,h,p;i=this.m_graphics.getPxSize(i,t.distanceTo(n)/2),e.length===0&&e.push(new primitives.common.MoveSegment(a)),o!==null&&(c=this._betweenPoint(t,n),h=this._offsetPoint(c,t,i),p=this._offsetPoint(c,n,i),e.push(new primitives.common.LineSegment(h)),e.push(new primitives.common.LineSegment(o)),e.push(new primitives.common.LineSegment(p))),e.push(new primitives.common.LineSegment(f)),u!==null?(e.push(new primitives.common.LineSegment(u)),e.push(new primitives.common.LineSegment(l))):e.push(new primitives.common.QuadraticArcSegment(n,l))},primitives.common.Callout.prototype._betweenPoint=function(e,t){return new primitives.common.Point((e.x+t.x)/2,(e.y+t.y)/2)},primitives.common.Callout.prototype._offsetPoint=function(e,t,n){var r=new primitives.common.Point(e);return e.x<t.x?r.x+=n:e.x>t.x?r.x-=n:e.y<t.y?r.y+=n:r.y-=n,r},primitives.common.Point=function(e,t){this.x=null,this.y=null;switch(arguments.length){case 1:this.x=e.x,this.y=e.y;break;case 2:this.x=e,this.y=t;break;default:}},primitives.common.Point.prototype.distanceTo=function(e,t){var n=0,r=0,i,s;switch(arguments.length){case 1:n=e.x,r=e.y;break;case 2:n=e,r=t;break;default:}return i=this.x-n,s=this.y-r,Math.sqrt(i*i+s*s)},primitives.common.Point.prototype.toString=function(e){var t="";return e=e!==undefined?e:"px",t+="left:"+this.x+e+";",t+="top:"+this.y+e+";",t},primitives.common.CubicArcSegment=function(e,t,n,r,i,s){this.x=null,this.y=null,this.cpX1=null,this.cpY1=null,this.cpX2=null,this.cpY2=null;switch(arguments.length){case 3:this.x=n.x,this.y=n.y,this.cpX1=e.x,this.cpY1=e.y,this.cpX2=t.x,this.cpY2=t.y;break;case 6:this.cpX1=e,this.cpY1=t,this.cpX2=n,this.cpY2=r,this.x=i,this.y=s;break;default:}this.segmentType=3},primitives.common.DotSegment=function(e,t,n){this.segmentType=4,this.x=e,this.y=t,this.radius=n},primitives.common.LineSegment=function(){this.parent=primitives.common.Point.prototype,this.parent.constructor.apply(this,arguments),this.segmentType=0},primitives.common.LineSegment.prototype=new primitives.common.Point,primitives.common.MoveSegment=function(){this.parent=primitives.common.Point.prototype,this.parent.constructor.apply(this,arguments),this.segmentType=1},primitives.common.LineSegment.prototype=new primitives.common.Point,primitives.common.QuadraticArcSegment=function(e,t,n,r){this.x=null,this.y=null,this.cpX=null,this.cpY=null;switch(arguments.length){case 2:this.x=t.x,this.y=t.y,this.cpX=e.x,this.cpY=e.y;break;case 4:this.cpX=e,this.cpY=t,this.x=n,this.y=r;break;default:}this.segmentType=2},primitives.common.Rect=function(e,t,n,r){this.x=null,this.y=null,this.width=null,this.height=null;switch(arguments.length){case 1:this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height;break;case 2:this.x=Math.min(e.x,t.x),this.y=Math.min(e.y,t.y),this.width=Math.abs(t.x-e.x),this.height=Math.abs(t.y-e.y);break;case 4:this.x=e,this.y=t,this.width=n,this.height=r;break;default:}},primitives.common.Rect.prototype.left=function(){return this.x},primitives.common.Rect.prototype.top=function(){return this.y},primitives.common.Rect.prototype.right=function(){return this.x+this.width},primitives.common.Rect.prototype.bottom=function(){return this.y+this.height},primitives.common.Rect.prototype.verticalCenter=function(){return this.y+this.height/2},primitives.common.Rect.prototype.horizontalCenter=function(){return this.x+this.width/2},primitives.common.Rect.prototype.isEmpty=function(){return this.x===null||this.y===null||this.width===null||this.height===null||this.width<0||this.height<0},primitives.common.Rect.prototype.offset=function(e,t,n,r){switch(arguments.length){case 1:this.x=this.x-e,this.y=this.y-e,this.width=this.width+e*2,this.height=this.height+e*2;break;case 4:this.x=this.x-e,this.y=this.y-t,this.width=this.width+e+n,this.height=this.height+t+r}return this},primitives.common.Rect.prototype.translate=function(e,t){return this.x=this.x+e,this.y=this.y+t,this},primitives.common.Rect.prototype.invert=function(){var e=this.width,t=this.x;return this.width=this.height,this.height=e,this.x=this.y,this.y=t,this},primitives.common.Rect.prototype.contains=function(e,t){switch(arguments.length){case 1:return this.x<=e.x&&e.x<=this.x+this.width&&this.y<=e.y&&e.y<=this.y+this.height;case 2:return this.x<=e&&e<=this.x+this.width&&this.y<=t&&t<=this.y+this.height;default:return!1}},primitives.common.Rect.prototype.cropByRect=function(e){return this.x<e.x&&(this.width-=e.x-this.x,this.x=e.x),this.right()>e.right()&&(this.width-=this.right()-e.right()),this.y<e.y&&(this.height-=e.y-this.y,this.y=e.y),this.bottom()>e.bottom()&&(this.height-=this.bottom()-e.bottom()),this.isEmpty()&&(this.x=null,this.y=null,this.width=null,this.height=null),this},primitives.common.Rect.prototype.addRect=function(e,t,n,r){var i,s;switch(arguments.length){case 1:e.isEmpty()||(this.isEmpty()?(this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height):(i=Math.max(this.right(),e.right()),s=Math.max(this.bottom(),e.bottom()),this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.width=i-this.x,this.height=s-this.y));break;case 2:this.isEmpty()?(this.x=e,this.y=t,this.width=0,this.height=0):(i=Math.max(this.right(),e),s=Math.max(this.bottom(),t),this.x=Math.min(this.x,e),this.y=Math.min(this.y,t),this.width=i-this.x,this.height=s-this.y);break;case 4:this.isEmpty()?(this.x=e,this.y=t,this.width=n,this.height=r):(i=Math.max(this.right(),e+n),s=Math.max(this.bottom(),t+r),this.x=Math.min(this.x,e),this.y=Math.min(this.y,t),this.width=i-this.x,this.height=s-this.y)}return this},primitives.common.Rect.prototype.getCSS=function(e){e=e!==undefined?e:"px";var t={left:this.x+e,top:this.y+e,width:this.width+e,height:this.height+e};return t},primitives.common.Rect.prototype.toString=function(e){var t="";return e=e!==undefined?e:"px",t+="left:"+this.x+e+";",t+="top:"+this.y+e+";",t+="width:"+this.width+e+";",t+="height:"+this.height+e+";",t},primitives.common.Size=function(e,t){this.width=0,this.height=0;switch(arguments.length){case 1:this.width=e.width,this.height=e.height;break;case 2:this.width=e,this.height=t;break;default:}},primitives.common.Size.prototype.invert=function(){var e=this.width;return this.width=this.height,this.height=e,this},primitives.common.Thickness=function(e,t,n,r){this.left=e,this.top=t,this.right=n,this.bottom=r},primitives.common.Thickness.prototype.isEmpty=function(){return this.left===0&&this.top===0&&this.right===0&&this.bottom===0},primitives.common.Thickness.prototype.toString=function(e){return e=e!==undefined?e:"px",this.left+e+", "+this.top+e+", "+this.right+e+", "+this.bottom+e},primitives.common.Graphics=function(e){var t;this.m_widget=e,this.m_placeholders={},this.m_activePlaceholder=null,this.m_cache=new primitives.common.Cache,this.boxModel=jQuery.support.boxModel,this.graphicsType=null,this.hasGraphics=!1},primitives.common.Graphics.prototype.clean=function(){var e,t,n,r;this.m_cache.clear(),this.m_cache=null,this.m_widget=null;for(e in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(e)){t=this.m_placeholders[e];for(n in t.layers)t.layers.hasOwnProperty(n)&&(r=t.layers[n],r.canvas.remove(),r.canvas=null);t.layers.length=0,t.activeLayer=null,t.size=null,t.rect=null,t.div=null}this.m_placeholders.length=0,this.m_activePlaceholder=null},primitives.common.Graphics.prototype.resize=function(e,t,n){var r=this.m_placeholders[e];r!=null&&this.resizePlaceholder(r,t,n)},primitives.common.Graphics.prototype.setTransform=function(e,t,n,r){var i=this.m_placeholders[e];i!=null&&(i.invertArea=t,i.invertHorizontally=n,i.invertVertically=r)},primitives.common.Graphics.prototype.resizePlaceholder=function(e,t,n){var r,i;e.size=new primitives.common.Size(t,n),e.rect=new primitives.common.Rect(0,0,t,n);for(r in e.layers)e.layers.hasOwnProperty(r)&&(i=e.layers[r],i.name!==-1&&i.canvas.css({position:"absolute",width:"0px",height:"0px"}))},primitives.common.Graphics.prototype.begin=function(){this.m_cache.begin()},primitives.common.Graphics.prototype.end=function(){this.m_cache.end()},primitives.common.Graphics.prototype.reset=function(e,t){var n="none",r=-1;switch(arguments.length){case 1:typeof e=="string"?n=e:r=e;break;case 2:n=e,r=t}this.m_cache.reset(n,r)},primitives.common.Graphics.prototype.activate=function(e,t){switch(arguments.length){case 1:typeof e=="string"?(this._activatePlaceholder(e),this._activateLayer(-1)):(this._activatePlaceholder("none"),this._activateLayer(e));break;case 2:this._activatePlaceholder(e),this._activateLayer(t)}return this.m_activePlaceholder},primitives.common.Graphics.prototype._activatePlaceholder=function(e){var t=this.m_placeholders[e],n;t===undefined&&(n=null,e==="none"?n=this.m_widget.element:n=this.m_widget.element.find("."+e),t=new primitives.common.Placeholder(e),t.div=n,t.size=new primitives.common.Size(n.innerWidth(),n.innerHeight()),t.rect=new primitives.common.Rect(0,0,t.size.width,t.size.height),this.m_placeholders[e]=t),this.m_activePlaceholder=t},primitives.common.Graphics.prototype._activateLayer=function(e){var t=this.m_activePlaceholder.layers[e],n,r,i,s,o;if(t===undefined){n=this.m_activePlaceholder;if(e===-1)t=new primitives.common.Layer(e),t.canvas=n.div;else{r=jQuery("<div></div>"),r.addClass("Layer"+e),i=new primitives.common.Rect(n.rect),r.css({position:"absolute",width:"0px",height:"0px"}),s=null;for(o in n.layers)n.layers.hasOwnProperty(o)&&(t=n.layers[o],t.name<e&&(s=s!==null?Math.max(s,t.name):t.name));t=new primitives.common.Layer(e),t.canvas=r,s===null?n.div.prepend(t.canvas[0]):t.canvas.insertAfter(n.layers[s].canvas)}n.layers[e]=t}this.m_activePlaceholder.activeLayer=t},primitives.common.Graphics.prototype.text=function(e,t,n,r,i,s,o,u,a){var f=this.m_activePlaceholder,l={position:"absolute",padding:0,margin:0,"text-align":this._getTextAlign(o),"font-size":a["font-size"],"font-family":a["font-family"],"font-weight":a["font-weight"],"font-style":a["font-style"],color:a["font-color"]},c="",h,p;f.transformRect(e,t,n,r,this,function(e,t,n,r){switch(s){case 0:l.left=e,l.top=t,l.width=n,l.height=r;break;case 1:l.left=e+Math.round(n/2-r/2),l.top=t+Math.round(r/2-n/2),l.width=r,l.height=n,c="rotate(-90deg)";break;case 2:l.left=e+Math.round(n/2-r/2),l.top=t+Math.round(r/2-n/2),l.width=r,l.height=n,c="rotate(90deg)"}l["-webkit-transform-origin"]="center center",l["-moz-transform-origin"]="center center",l["-o-transform-origin"]="center center",l["-ms-transform-origin"]="center center",l["-webkit-transform"]=c,l["-moz-transform"]=c,l["-o-transform"]=c,l["-ms-transform"]=c,l.transform=c,l["max-width"]=l.width,l["max-height"]=l.height,i=i.replace(new RegExp("\n","g"),"<br/>");switch(u){case 0:h=this.m_cache.get(f.name,f.activeLayer.name,"text"),h===null?(h=jQuery("<div></div>"),h.css(l),h.html(i),f.activeLayer.canvas.append(h),this.m_cache.put(f.name,f.activeLayer.name,"text",h)):(h.css(l),h.html(i));break;default:l["border-collapse"]="collapse",p={"vertical-align":this._getVerticalAlignment(u),padding:0},h=this.m_cache.get(f.name,f.activeLayer.name,"textintable"),h===null?(h=jQuery("<table><tbody><tr><td></td></tr></tbody></table>"),primitives.common.css(h,l),h.find("td").css(p).html(i),f.activeLayer.canvas.append(h),this.m_cache.put(f.name,f.activeLayer.name,"textintable",h)):(primitives.common.css(h,l),h.find("td").css(p).html(i))}})},primitives.common.Graphics.prototype._getTextAlign=function(e){var t=null;switch(e){case 0:t="center";break;case 1:t="left";break;case 2:t="right"}return t},primitives.common.Graphics.prototype._getVerticalAlignment=function(e){var t=null;switch(e){case 1:t="middle";break;case 0:t="top";break;case 2:t="bottom"}return t},primitives.common.Graphics.prototype.polyline=function(e,t){var n=null,r=null,i,s;for(i=0;i<e.length;i+=1){s=e[i];switch(s.segmentType){case 1:n=Math.round(s.x)+.5,r=Math.round(s.y)+.5;break;case 0:this.rightAngleLine(n,r,Math.round(s.x)+.5,Math.round(s.y)+.5,t);break;case 4:this.dot(s.x,s.y,s.radius,t)}}},primitives.common.Graphics.prototype.dot=function(e,t,n,r){var i=this.m_activePlaceholder,s=this.m_cache.get(i.name,i.activeLayer.name,"dot");i.transformPoint(e,t,this,function(e,t){var o={position:"absolute",width:n*2,top:t-n+.5,left:e-n+.5,padding:0,margin:0,"line-height":"0px",overflow:"hidden",height:n*2,background:r.fillColor,"-moz-border-radius":n,"-webkit-border-radius":n,"-khtml-border-radius":n,"border-radius":n,"font-size":"0px","border-style":"None","border-width":"0px"};s===null?(s=jQuery("<div></div>"),primitives.common.css(s,o),i.activeLayer.canvas.append(s),this.m_cache.put(i.name,i.activeLayer.name,"dot",s)):primitives.common.css(s,o)})},primitives.common.Graphics.prototype.rightAngleLine=function(e,t,n,r,i){var s=this.m_activePlaceholder;s.transformPoints(e,t,n,r,this,function(e,t,n,r){var o="",u=Math.abs(r-t)>Math.abs(n-e),a=i.lineWidth,f={position:"absolute",top:Math.round(Math.min(t,r)-(u?0:a/2)),left:Math.round(Math.min(e,n)-(u?a/2:0)),padding:0,margin:0,opacity:.5,"line-height":"0px",overflow:"hidden",background:i.borderColor,"font-size":"0px"},l;u?(f.width=a,f.height=Math.abs(Math.round(r-t))):(f.width=Math.abs(Math.round(n-e)),f.height=a),l=this.m_cache.get(s.name,s.activeLayer.name,"rect"),l===null?(l=jQuery("<div></div>"),primitives.common.css(l,f),s.activeLayer.canvas.append(l),this.m_cache.put(s.name,s.activeLayer.name,"rect",l)):primitives.common.css(l,f)})},primitives.common.Graphics.prototype.template=function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=this.m_activePlaceholder,d;return p.transformRect(e,t,n,r,this,function(e,t,n,r){var v="template"+(f!==null)?f:primitives.common.hashCode(a),m=0,g;d=this.m_cache.get(p.name,p.activeLayer.name,v),h!==null&&h["border-width"]!==undefined&&(m=this.boxModel?this.getPxSize(h["border-width"]):0),g={width:o-m+"px",height:u-m+"px",top:t+s+"px",left:e+i+"px"},jQuery.extend(g,h),c===null&&(c=new primitives.common.RenderEventArgs),d===null?(d=jQuery(a),jQuery.extend(g,{position:"absolute",overflow:"hidden",padding:"0px",margin:"0px"},h),primitives.common.css(d,g),c.element=d,c.renderingMode=0,l!==null&&this.m_widget._trigger(l,null,c),p.activeLayer.canvas.append(d),this.m_cache.put(p.name,p.activeLayer.name,v,d)):(c.element=d,c.renderingMode=1,primitives.common.css(d,g),l!==null&&this.m_widget._trigger(l,null,c))}),d},primitives.common.Graphics.prototype.getPxSize=function(e,t){var n=e;return typeof e=="string"&&(e.indexOf("pt")>0?n=parseInt(e,10)*96/72:e.indexOf("%")>0?n=parseFloat(e)/100*t:n=parseInt(e,10)),n},primitives.common.Cache=function(){this.threshold=20,this.m_visible={},this.m_invisible={}},primitives.common.Cache.prototype.begin=function(){var e,t,n,r;for(e in this.m_visible)if(this.m_visible.hasOwnProperty(e))for(t in this.m_visible[e])if(this.m_visible[e].hasOwnProperty(t)){for(n=this.m_visible[e][t].length-1;n>=0;n-=1)r=this.m_visible[e][t][n],r.css({visibility:"hidden"}),this.m_invisible[e][t].push(r);this.m_visible[e][t].length=0}},primitives.common.Cache.prototype.end=function(){var e,t,n;for(e in this.m_visible)if(this.m_visible.hasOwnProperty(e))for(t in this.m_visible[e])if(this.m_visible[e].hasOwnProperty(t)){n=null;if(this.m_invisible[e][t].length>this.threshold)while((n=this.m_invisible[e][t].pop())!==undefined)n.remove()}},primitives.common.Cache.prototype.reset=function(e,t){e=e+"-"+t;var n=null,r,i;for(r in this.m_visible[e])if(this.m_visible[e].hasOwnProperty(r)){for(i=this.m_visible[e][r].length-1;i>=0;i-=1)n=this.m_visible[e][r][i],this.m_invisible[e][r].push(n),n.css({visibility:"hidden"});this.m_visible[e][r].length=0}},primitives.common.Cache.prototype.clear=function(){var e,t,n;for(e in this.m_visible)if(this.m_visible.hasOwnProperty(e))for(t in this.m_visible[e])if(this.m_visible[e].hasOwnProperty(t)){n=null;while((n=this.m_visible[e][t].pop())!==undefined)n.remove();while((n=this.m_invisible[e][t].pop())!==undefined)n.remove()}},primitives.common.Cache.prototype.get=function(e,t,n){e=e+"-"+t;var r=null;return this.m_visible[e]===undefined&&(this.m_visible[e]={},this.m_invisible[e]={}),this.m_visible[e][n]===undefined&&(this.m_visible[e][n]=[],this.m_invisible[e][n]=[]),r=this.m_invisible[e][n].pop()||null,r!==null&&(this.m_visible[e][n].push(r),r.css({visibility:"inherit"})),r},primitives.common.Cache.prototype.put=function(e,t,n,r){e=e+"-"+t,this.m_visible[e][n].push(r)},primitives.common.CanvasGraphics=function(e){this.parent=primitives.common.Graphics.prototype,this.parent.constructor.apply(this,arguments),this.graphicsType=1,this.m_maximum=6e3},primitives.common.CanvasGraphics.prototype=new primitives.common.Graphics,primitives.common.CanvasGraphics.prototype.clean=function(){var e,t,n,r;for(e in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(e)){t=this.m_placeholders[e];for(n in t.layers)t.layers.hasOwnProperty(n)&&(r=t.layers[n],r.canvascanvas!==null&&(r.canvascanvas.remove(),r.canvascanvas=null))}this.parent.clean.apply(this,arguments)},primitives.common.CanvasGraphics.prototype._activatePlaceholder=function(e){var t,n,r;this.parent._activatePlaceholder.apply(this,arguments),t=this.m_activePlaceholder,n=t.size.width,r=t.size.height,n>this.m_maximum||r>this.m_maximum?t.hasGraphics=!1:t.hasGraphics=!0},primitives.common.CanvasGraphics.prototype.resizePlaceholder=function(e,t,n){var r,i;this.parent.resizePlaceholder.apply(this,arguments);for(r in e.layers)e.layers.hasOwnProperty(r)&&(i=e.layers[r],i.canvascanvas!==null&&(i.canvascanvas.css({position:"absolute",width:t+"px",height:n+"px"}),i.canvascanvas.attr({width:t+"px",height:n+"px"})))},primitives.common.CanvasGraphics.prototype.begin=function(){var e,t,n,r,i,s;this.parent.begin.apply(this);for(e in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(e)){t=this.m_placeholders[e],i=t.size.width,s=t.size.height;for(n in t.layers)t.layers.hasOwnProperty(n)&&(r=t.layers[n],r.canvascanvas!==null&&r.canvascontext.clearRect(0,0,i,s))}},primitives.common.Graphics.prototype._getContext=function(e,t){var n=e.size.width,r=e.size.height;return t.canvascanvas===null&&(t.canvascanvas=jQuery("<canvas></canvas>"),t.canvascanvas.attr({width:n+"px",height:r+"px"}),e.activeLayer.canvas.prepend(t.canvascanvas),t.canvascontext=t.canvascanvas[0].getContext("2d")),t.canvascontext},primitives.common.CanvasGraphics.prototype.reset=function(e,t){var n="none",r=-1,i,s,o,u;switch(arguments.length){case 1:typeof e=="string"?n=e:r=e;break;case 2:n=e,r=t}this.parent.reset.apply(this,arguments),i=this.m_placeholders[n],i!==undefined&&(o=i.size.width,u=i.size.height,s=i.layers[r],s!==undefined&&s.canvascanvas!==null&&s.canvascontext.clearRect(0,0,o,u))},primitives.common.CanvasGraphics.prototype.polyline=function(e,t){var n=this.m_activePlaceholder,r,i,s,o;if(!n.hasGraphics)this.parent.polyline.apply(this,arguments);else{r=n.activeLayer,i=this._getContext(n,r),i.save(),t.lineWidth!==undefined&&t.borderColor!==
undefined?(i.strokeStyle=t.borderColor,i.lineWidth=t.lineWidth):(i.lineWidth=0,i.strokeStyle="Transparent"),i.beginPath();for(s=0;s<e.length;s+=1){o=e[s];switch(o.segmentType){case 1:n.transformPoint(Math.floor(o.x)+.5,Math.floor(o.y)+.5,this,function(e,t){i.moveTo(e,t)});break;case 0:n.transformPoint(Math.floor(o.x)+.5,Math.floor(o.y)+.5,this,function(e,t){i.lineTo(e,t)});break;case 4:n.transformPoint(Math.floor(o.x)+.5,Math.floor(o.y)+.5,this,function(e,t){i.moveTo(e,t),i.arc(e,t,Math.floor(o.radius),0,2*Math.PI,!1)});break;case 2:n.transformPoints(Math.floor(o.cpX)+.5,Math.floor(o.cpY)+.5,Math.floor(o.x)+.5,Math.floor(o.y)+.5,this,function(e,t,n,r){i.quadraticCurveTo(e,t,n,r)});break;case 3:n.transform3Points(Math.floor(o.cpX1)+.5,Math.floor(o.cpY1)+.5,Math.floor(o.cpX2)+.5,Math.floor(o.cpY2)+.5,Math.floor(o.x)+.5,Math.floor(o.y)+.5,this,function(e,t,n,r,s,o){i.bezierCurveTo(e,t,n,r,s,o)})}}t.lineWidth!==undefined&&i.stroke(),t.fillColor!==undefined&&(i.fillStyle=t.fillColor,i.globalAlpha=t.opacity,i.fill()),i.restore()}},primitives.common.Element=function(e,t){this.ns=null,this.name=null,this.attr={},this.style={},this.children=[];switch(arguments.length){case 1:this.name=e;break;case 2:this.ns=e,this.name=t;break;default:}},primitives.common.Element.prototype.setAttribute=function(e,t){this.attr[e]=t},primitives.common.Element.prototype.appendChild=function(e){this.children[this.children.length]=e},primitives.common.Element.prototype.create=function(e){var t=null,n,r,i;this.ns!==null?t=document.createElementNS(this.ns,this.name):t=document.createElement(this.name);for(n in this.attr)this.attr.hasOwnProperty(n)&&(e!==undefined?t[n]=this.attr[n]:t.setAttribute(n,this.attr[n]));for(n in this.style)this.style.hasOwnProperty(n)&&(t.style[n]=this.style[n]);for(i=0;i<this.children.length;i+=1)r=this.children[i],typeof r=="string"?t.appendChild(document.createTextNode(r)):t.appendChild(r.create(e));return t},primitives.common.Element.prototype.update=function(e,t){var n,r,i,s,o;for(n in this.style)this.style.hasOwnProperty(n)&&(o=this.style[n],e.style[n]!==o&&(e.style[n]=o));for(n in this.attr)this.attr.hasOwnProperty(n)&&(o=this.attr[n],t!==undefined?e[n]!==o&&(e[n]=o):e.getAttribute(n)!==o&&e.setAttribute(n,o));r=this.children.length;for(i=0;i<r;i+=1)s=this.children[i],typeof s=="string"?e.innerHtml!==s&&(e.innerHtml=s):this.children[i].update(e.children[i],t)},primitives.common.Layer=function(e){this.name=e,this.canvas=null,this.canvascanvas=null,this.svgcanvas=null},primitives.common.Placeholder=function(e){this.name=e,this.invertArea=null,this.invertHorizontally=null,this.invertVertically=null,this.layers={},this.activeLayer=null,this.size=null,this.rect=null,this.div=null,this.hasGraphics=!0},primitives.common.Placeholder.prototype.transformPointBack=function(e,t,n,r){var i;this.invertHorizontally&&(e=this.size.width-e),this.invertVertically&&(t=this.size.height-t),this.invertArea&&(i=e,e=t,t=i),r.call(n,e,t)},primitives.common.Placeholder.prototype.transformPoint=function(e,t,n,r){var i;this.invertArea&&(i=e,e=t,t=i),this.invertHorizontally&&(e=this.size.width-e),this.invertVertically&&(t=this.size.height-t),r.call(n,e,t)},primitives.common.Placeholder.prototype.transformPoints=function(e,t,n,r,i,s){var o;this.invertArea&&(o=e,e=t,t=o,o=n,n=r,r=o),this.invertHorizontally&&(e=this.size.width-e,n=this.size.width-n),this.invertVertically&&(t=this.size.height-t,r=this.size.height-r),s.call(i,e,t,n,r)},primitives.common.Placeholder.prototype.transform3Points=function(e,t,n,r,i,s,o,u){var a;this.invertArea&&(a=e,e=t,t=a,a=n,n=r,r=a,a=i,i=s,s=a),this.invertHorizontally&&(e=this.size.width-e,n=this.size.width-n,i=this.size.width-i),this.invertVertically&&(t=this.size.height-t,r=this.size.height-r,s=this.size.height-s),u.call(o,e,t,n,r,i,s)},primitives.common.Placeholder.prototype.transformRect=function(e,t,n,r,i,s){var o;this.invertArea&&(o=e,e=t,t=o,o=n,n=r,r=o),this.invertHorizontally&&(e=this.size.width-e-n),this.invertVertically&&(t=this.size.height-t-r),s.call(i,e,t,n,r)},primitives.common.SvgGraphics=function(e){this.parent=primitives.common.Graphics.prototype,this.parent.constructor.apply(this,arguments),this._svgxmlns="http://www.w3.org/2000/svg",this.graphicsType=0,this.hasGraphics=!0},primitives.common.SvgGraphics.prototype=new primitives.common.Graphics,primitives.common.SvgGraphics.prototype.clean=function(){var e,t,n,r;for(e in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(e)){t=this.m_placeholders[e];for(n in t.layers)t.layers.hasOwnProperty(n)&&(r=t.layers[n],r.svgcanvas!==null&&(r.svgcanvas.remove(),r.svgcanvas=null))}this.parent.clean.apply(this,arguments)},primitives.common.SvgGraphics.prototype.resizePlaceholder=function(e,t,n){var r,i,s;this.parent.resizePlaceholder.apply(this,arguments);for(r in e.layers)e.layers.hasOwnProperty(r)&&(i=e.layers[r],i.svgcanvas!==null&&(s={position:"absolute",width:t+"px",height:n+"px"},i.svgcanvas.css(s)))},primitives.common.SvgGraphics.prototype._getCanvas=function(){var e=this.m_activePlaceholder,t=e.activeLayer,n=e.rect;return t.svgcanvas===null&&(t.svgcanvas=jQuery('<svg version = "1.1"></svg>'),t.svgcanvas.attr({viewBox:n.x+" "+n.y+" "+n.width+" "+n.height}),t.svgcanvas.css({width:n.width+"px",height:n.height+"px"}),e.activeLayer.canvas.prepend(t.svgcanvas)),t.svgcanvas},primitives.common.SvgGraphics.prototype.polyline=function(e,t){var n=this.m_activePlaceholder,r,i,s,o,u,a;r=new primitives.common.Element(this._svgxmlns,"path"),t.fillColor!==undefined?(r.setAttribute("fill",t.fillColor),r.setAttribute("fill-opacity",t.opacity)):r.setAttribute("fill-opacity",0),t.lineWidth!==undefined&&t.borderColor!==undefined?(r.setAttribute("stroke",t.borderColor),r.setAttribute("stroke-width",t.lineWidth)):(r.setAttribute("stroke","transparent"),r.setAttribute("stroke-width",0)),i="";for(s=0;s<e.length;s+=1){o=e[s];switch(o.segmentType){case 1:n.transformPoint(Math.floor(o.x)+.5,Math.floor(o.y)+.5,this,function(e,t){i+="M"+e+" "+t});break;case 0:n.transformPoint(Math.floor(o.x)+.5,Math.floor(o.y)+.5,this,function(e,t){i+="L"+e+" "+t});break;case 2:n.transformPoints(Math.floor(o.cpX)+.5,Math.floor(o.cpY)+.5,Math.floor(o.x)+.5,Math.floor(o.y)+.5,this,function(e,t,n,r){i+="Q"+e+" "+t+" "+n+" "+r});break;case 4:n.transformPoints(Math.floor(o.x-o.radius)+.5,Math.floor(o.y)+.5,Math.floor(o.x+o.radius)+.5,Math.floor(o.y)+.5,this,function(e,t,n,r){i+="M"+e+" "+t,i+="A"+o.radius+" "+o.radius+" 0 1 0 "+n+" "+r,i+="A"+o.radius+" "+o.radius+" 0 1 0 "+e+" "+t});break;case 3:n.transform3Points(Math.floor(o.cpX1)+.5,Math.floor(o.cpY1)+.5,Math.floor(o.cpX2)+.5,Math.floor(o.cpY2)+.5,Math.floor(o.x)+.5,Math.floor(o.y)+.5,this,function(e,t,n,r,s,o){i+="C"+e+" "+t+" "+n+" "+r+" "+s+" "+o})}}r.setAttribute("d",i),u=this.m_cache.get(n.name,n.activeLayer.name,"path"),u===null?(u=jQuery(r.create()),a=this._getCanvas(),a.append(u),this.m_cache.put(n.name,n.activeLayer.name,"path",u)):r.update(u[0])},primitives.common.VmlGraphics=function(widget){var vmlStyle,names,index;this.parent=primitives.common.Graphics.prototype,this.parent.constructor.apply(this,arguments),this.prefix="rvml",this.ie8mode=document.documentMode&&document.documentMode>=8;try{eval("document.namespaces")}catch(ex){}document.namespaces[this.prefix]||document.namespaces.add(this.prefix,"urn:schemas-microsoft-com:vml");if(!primitives.common.VmlGraphics.prototype.vmlStyle){vmlStyle=primitives.common.VmlGraphics.prototype.vmlStyle=document.createStyleSheet(),names=[" *","fill","shape","path","textpath"];for(index=0;index<names.length;index+=1)vmlStyle.addRule(this.prefix+"\\:"+names[index],"behavior:url(#default#VML); position:absolute;")}this.graphicsType=2,this.hasGraphics=!0},primitives.common.VmlGraphics.prototype=new primitives.common.Graphics,primitives.common.VmlGraphics.prototype.text=function(e,t,n,r,i,s,o,u,a){var f,l,c,h,p,d,v,m,g,y,b,w;s===0?this.parent.text.call(this,e,t,n,r,i,s,o,u,a):(f=this.m_activePlaceholder,f.transformRect(e,t,n,r,this,function(e,t,n,r){l=s===1,c=new primitives.common.Rect(e,t,n,r),h=new primitives.common.Rect(0,0,n*10,r*10),p=new primitives.common.Element(this.prefix+":shape"),p.setAttribute("CoordSize",h.width+","+h.height),p.setAttribute("filled",!0),p.setAttribute("stroked",!1),p.setAttribute("fillcolor",a["font-color"]),p.style.top=c.y+"px",p.style.left=c.x+"px",p.style.width=c.width+"px",p.style.height=c.height+"px",p.style["font-family"]=a["font-family"],d=new primitives.common.Element(this.prefix+":path"),d.setAttribute("TextPathOk",!0),v=10*Math.floor(this.getPxSize(a["font-size"]))*1.6,m=v*Math.max(i.split("\n").length-1,1),g=null,y=null;if(l)switch(u){case 0:g=new primitives.common.Point(h.x+m/2,h.bottom()),y=new primitives.common.Point(h.x+m/2,h.y);break;case 1:g=new primitives.common.Point(h.horizontalCenter(),h.bottom()),y=new primitives.common.Point(h.horizontalCenter(),h.y);break;case 2:g=new primitives.common.Point(h.right()-m/2,h.bottom()),y=new primitives.common.Point(h.right()-m/2,h.y)}else switch(u){case 0:g=new primitives.common.Point(h.right()-m/2,h.y),y=new primitives.common.Point(h.right()-m/2,h.bottom());break;case 1:g=new primitives.common.Point(h.horizontalCenter(),h.y),y=new primitives.common.Point(h.horizontalCenter(),h.bottom());break;case 2:g=new primitives.common.Point(h.x+m/2,h.y),y=new primitives.common.Point(h.x+m/2,h.bottom())}d.setAttribute("v"," m"+g.x+","+g.y+" l"+y.x+","+y.y+" e"),b=new primitives.common.Element(this.prefix+":textpath"),b.setAttribute("on",!0),b.setAttribute("string",i),b.style.trim=!1,b.style["v-text-align"]=this._getTextAlign(o),b.style.font="normal normal normal "+a["font-size"]+"pt "+a["font-family"],p.appendChild(d),p.appendChild(b),w=this.m_cache.get(f.name,f.activeLayer.name,"vmltext"),w===null?(w=jQuery(p.create(this.ie8mode)),f.activeLayer.canvas.append(w),this.m_cache.put(f.name,f.activeLayer.name,"vmltext",w)):p.update(w[0],this.ie8mode)}))},primitives.common.VmlGraphics.prototype.polyline=function(e,t){var n=this.m_activePlaceholder,r=new primitives.common.Rect(n.rect),i=new primitives.common.Rect(0,0,r.width*10,r.height*10),s=new primitives.common.Element(this.prefix+":shape"),o,u,a,f,l,c;t.borderColor!==undefined&&t.lineWidth!==undefined?(s.setAttribute("strokecolor",t.borderColor),s.setAttribute("strokeweight",t.lineWidth),s.setAttribute("stroked",!0)):s.setAttribute("stroked",!1),s.setAttribute("CoordSize",i.width+","+i.height),s.style.top=r.y+"px",s.style.left=r.x+"px",s.style.width=r.width+"px",s.style.height=r.height+"px",o="";for(a=0;a<e.length;a+=1){u=e[a];switch(u.segmentType){case 1:n.transformPoint(Math.floor(u.x),Math.floor(u.y),this,function(e,t){o+=" m"+10*e+","+10*t});break;case 0:n.transformPoint(Math.floor(u.x),Math.floor(u.y),this,function(e,t){o+=" l"+10*e+","+10*t});break;case 4:n.transformPoints(Math.floor(u.x-u.radius),Math.floor(u.y-u.radius),Math.floor(u.x+u.radius),Math.floor(u.y+u.radius),this,function(e,t,n,r){var i;e>n&&(i=e,e=n,n=i),t>r&&(i=t,t=r,r=i),e=10*e+5,t=10*t+5,n=10*n-5,r=10*r-5,o+=" m"+e+","+t,o+=" l"+n+","+t,o+=" l"+n+","+r,o+=" l"+e+","+r,o+=" l"+e+","+t});break;case 2:n.transformPoints(Math.floor(u.cpX),Math.floor(u.cpY),Math.floor(u.x),Math.floor(u.y),this,function(e,t,n,r){o+=" qb"+10*e+","+10*t+" l"+10*n+","+10*r});break;case 3:n.transform3Points(Math.floor(u.cpX1),Math.floor(u.cpY1),Math.floor(u.cpX2),Math.floor(u.cpY2),Math.floor(u.x),Math.floor(u.y),this,function(e,t,n,r,i,s){o+=" c"+10*e+","+10*t+","+10*n+","+10*r+","+10*i+","+10*s})}}o+=" e",f=new primitives.common.Element(this.prefix+":path"),f.setAttribute("v",o),s.appendChild(f),t.fillColor!==null?(s.setAttribute("filled",!0),l=new primitives.common.Element(this.prefix+":fill"),l.setAttribute("opacity",t.opacity),l.setAttribute("color",t.fillColor),s.appendChild(l)):s.setAttribute("filled",!1),c=this.m_cache.get(n.name,n.activeLayer.name,"shapepath"),c===null?(c=jQuery(s.create(this.ie8mode)),n.activeLayer.canvas.append(c),this.m_cache.put(n.name,n.activeLayer.name,"shapepath",c)):s.update(c[0],this.ie8mode)},primitives.text.Config=function(){this.classPrefix="bptext",this.graphicsType=0,this.actualGraphicsType=null,this.orientation=0,this.text="",this.verticalAlignment=1,this.horizontalAlignment=0,this.fontSize="16px",this.fontFamily="Arial",this.color="#000000",this.fontWeight="normal",this.fontStyle="normal"},primitives.text.Controller=function(){this.widgetEventPrefix="bptext",this.options=new primitives.text.Config,this.m_placeholder=null,this.m_panelSize=null,this.m_graphics=null},primitives.text.Controller.prototype._create=function(){this.element.addClass("ui-widget"),this._createLayout(),this._redraw()},primitives.text.Controller.prototype.destroy=function(){this._cleanLayout()},primitives.text.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight()),this.m_placeholder=jQuery("<div></div>"),this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"}),this.m_placeholder.css(this.m_panelSize.getCSS()),this.m_placeholder.addClass("placeholder"),this.m_placeholder.addClass(this.widgetEventPrefix),this.element.append(this.m_placeholder),this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this),this.options.actualGraphicsType=this.m_graphics.graphicsType},primitives.text.Controller.prototype._cleanLayout=function(){this.m_graphics!==null&&this.m_graphics.clean(),this.m_graphics=null,this.element.find("."+this.widgetEventPrefix).remove()},primitives.text.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight()),this.m_placeholder.css(this.m_panelSize.getCSS())},primitives.text.Controller.prototype.update=function(e){e?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())},primitives.text.Controller.prototype._redraw=function(){var e=this.m_graphics.activate("placeholder"),t={"font-size":this.options.fontSize,"font-family":this.options.fontFamily,"font-style":this.options.fontStyle,"font-weight":this.options.fontWeight,"font-color":this.options.color},n=this.m_graphics.text(e.rect.x,e.rect.y,e.rect.width,e.rect.height,this.options.text,this.options.orientation,this.options.horizontalAlignment,this.options.verticalAlignment,t)},primitives.text.Controller.prototype._setOption=function(e,t){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(e){case"disabled":var n=jQuery([]);t?(n.filter(".ui-state-focus").blur(),n.removeClass("ui-state-hover"),n.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(n.propAttr("disabled",!1),this.element.removeClass("ui-disabled"));break;default:}},function(e){e.widget("ui.bpText",new primitives.text.Controller)}(jQuery),primitives.callout.Config=function(){this.classPrefix="bpcallout",this.graphicsType=1,this.actualGraphicsType=null,this.pointerPlacement=0,this.position=null,this.snapPoint=null,this.cornerRadius="10%",this.offset=0,this.opacity=1,this.lineWidth=1,this.pointerWidth="10%",this.borderColor="#000000",this.fillColor="#d3d3d3"},primitives.callout.Controller=function(){this.widgetEventPrefix="bpcallout",this.options=new primitives.callout.Config,this.m_placeholder=null,this.m_panelSize=null,this.m_graphics=null,this.m_shape=null},primitives.callout.Controller.prototype._create=function(){this.element.addClass("ui-widget"),this._createLayout(),this._redraw()},primitives.callout.Controller.prototype.destroy=function(){this._cleanLayout()},primitives.callout.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight()),this.m_placeholder=jQuery("<div></div>"),this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"}),this.m_placeholder.css(this.m_panelSize.getCSS()),this.m_placeholder.addClass("placeholder"),this.m_placeholder.addClass(this.widgetEventPrefix),this.element.append(this.m_placeholder),this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this),this.options.actualGraphicsType=this.m_graphics.graphicsType,this.m_shape=new primitives.common.Callout(this.m_graphics)},primitives.callout.Controller.prototype._cleanLayout=function(){this.m_graphics!==null&&this.m_graphics.clean(),this.m_graphics=null,this.element.find("."+this.widgetEventPrefix).remove()},primitives.callout.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight()),this.m_placeholder.css(this.m_panelSize.getCSS())},primitives.callout.Controller.prototype.update=function(e){e?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())},primitives.callout.Controller.prototype._redraw=function(){var e=this.m_graphics.activate("placeholder"),t=["pointerPlacement","cornerRadius","offset","opacity","lineWidth","pointerWidth","borderColor","fillColor"],n,r;for(n=0;n<t.length;n+=1)r=t[n],this.m_shape[r]=this.options[r];this.m_shape.draw(this.options.snapPoint,this.options.position)},primitives.callout.Controller.prototype._setOption=function(e,t){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(e){case"disabled":var n=jQuery([]);t?(n.filter(".ui-state-focus").blur(),n.removeClass("ui-state-hover"),n.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(n.propAttr("disabled",!1),this.element.removeClass("ui-disabled"));break;default:}},function(e){e.widget("ui.bpCallout",new primitives.callout.Controller)}(jQuery),primitives.orgdiagram.TemplateConfig=function(){this.name=null,this.itemSize=new primitives.common.Size(120,100),this.itemBorderWidth=1,this.itemTemplate=null,this.minimizedItemSize=new primitives.common.Size(4,4),this.highlightPadding=new primitives.common.Thickness(2,2,2,2),this.highlightBorderWidth=1,this.highlightTemplate=null,this.cursorPadding=new primitives.common.Thickness(3,3,3,3),this.cursorBorderWidth=2,this.cursorTemplate=null},primitives.orgdiagram.ButtonConfig=function(e,t){this.name=e,this.icon=t,this.text=!1,this.label=null,this.size=new primitives.common.Size(16,16)},primitives.orgdiagram.Config=function(e){this.name=e!==undefined?e:"OrgDiagram",this.classPrefix="orgdiagram",this.graphicsType=0,this.actualGraphicsType=null,this.pageFitMode=3,this.orientationType=primitives.orgdiagram.OrientationType.Top,this.verticalAlignment=1,this.horizontalAlignment=0,this.connectorType=1,this.emptyDiagramMessage="Diagram is empty.",this.rootItem=null,this.highligtItem=null,this.cursorItem=null,this.selectedItems=[],this.hasSelectorCheckbox=0,this.selectionPathMode=1,this.minimalVisibility=2,this.templates=[],this.defaultTemplateName=null,this.hasButtons=0,this.buttons=[],this.onHighlightChanging=null,this.onHighlightChanged=null,this.onCursorChanging=null,this.onCursorChanged=null,this.onSelectionChanging=null,this.onSelectionChanged=null,this.onButtonClick=null,this.onMouseClick=null,this.onItemRender=null,this.onHighlightRender=null,this.onCursorRender=null,this.normalLevelShift=20,this.dotLevelShift=20,this.lineLevelShift=10,this.normalItemsInterval=10,this.dotItemsInterval=1,this.lineItemsInterval=2,this.cousinsIntervalMultiplier=5,this.itemTitleFirstFontColor="#ffffff",this.itemTitleSecondFontColor="#000080",this.selectCheckBoxLabel="Selected",this.linesColor="#c0c0c0",this.linesWidth=1,this.calloutfillColor="#000000",this.calloutBorderColor=null,this.calloutOffset=4,this.calloutCornerRadius=4,this.calloutPointerWidth="10%",this.calloutLineWidth=1,this.calloutOpacity=.2,this.childrenPlacementType=2,this.leavesPlacementType=2,this.maximumColumnsInMatrix=6,this.buttonsPanelSize=28,this.groupTitlePanelSize=24,this.checkBoxPanelSize=24,this.distance=3,this.minimumScale=.5,this.maximumScale=1},primitives.orgdiagram.ItemConfig=function(e,t,n){this.title=null,this.description=null,this.image=null,this.itemTitleColor="#4169e1",this.groupTitle=null,this.groupTitleColor="#4169e1",this.isVisible=!0,this.hasSelectorCheckbox=0,this.hasButtons=0,this.itemType=0,this.adviserPlacementType=0,this.childrenPlacementType=0,this.items=[],this.templateName=null;switch(arguments.length){case 3:this.title=e,this.description=t,this.image=n}},primitives.orgdiagram.Controller=function(){this.widgetEventPrefix="orgdiagram",this.options=new primitives.orgdiagram.Config,this.graphics=null,this._treeItems={},this._treeItemCounter=0,this._treeLevels=[],this._leftMargins={},this._rightMargins={},this._templates={},this._defaultTemplate=null,this._checkBoxTemplate=null,this._checkBoxTemplateHashCode=null,this._buttonsTemplate=null,this._buttonsTemplateHashCode=null,this._groupTitleTemplate=null,this._groupTitleTemplateHashCode=null,this._selectedTreeItems=[],this._cursorTreeItem=null,this._highlightTreeItem=null,this.m_scrollPanel=null,this.m_scrollPanelRect=new primitives.common.Rect(0,0,0,0),this.m_placeholder=null,this.m_placeholderRect=new primitives.common.Rect(0,0,0,0),this.m_calloutPlaceholder=null,this.m_calloutShape=null,this.boxModel=jQuery.support.boxModel,this._cancelMouseClick=!1,this._itemsInterval=[],this._scale=null,this.scale=1},primitives.orgdiagram.Controller.prototype._create=function(){this.element.addClass("ui-widget"),this._createLayout(),this._bind(),this.graphics=null,this._redraw()},primitives.orgdiagram.Controller.prototype.destroy=function(){this._unbind(),this._clean(),this._cleanLayout()},primitives.orgdiagram.Controller.prototype._clean=function(){this.graphics!==null&&this.graphics.clean(),this.graphics=null},primitives.orgdiagram.Controller.prototype._cleanLayout=function(){this._mouseDestroy(),this.element.find("."+this.widgetEventPrefix).remove()},primitives.orgdiagram.Controller.prototype._createLayout=function(){this.m_scrollPanelRect=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight()),this.m_placeholderRect=new primitives.common.Rect(this.m_scrollPanelRect),this.m_scrollPanel=jQuery("<div></div>"),this.m_scrollPanel.css({position:"relative",overflow:"auto",top:"0px",left:"0px",padding:"0px",margin:"0px","-webkit-overflow-scrolling":"touch"}),this.m_scrollPanel.addClass(this.widgetEventPrefix),this.m_scrollPanel.css(this.m_scrollPanelRect.getCSS()),this.m_placeholder=jQuery("<div></div>"),this.m_placeholder.css({position:"absolute",overflow:"hidden",top:"0px",left:"0px"}),this.m_placeholder.addClass("placeholder"),this.m_placeholder.addClass(this.widgetEventPrefix),this.m_placeholder.css(this.m_placeholderRect.getCSS()),this.m_scrollPanel.append(this.m_placeholder),this.m_calloutPlaceholder=jQuery("<div></div>"),this.m_calloutPlaceholder.css({position:"absolute",overflow:"visible"}),this.m_calloutPlaceholder.addClass("calloutplaceholder"),this.m_calloutPlaceholder.addClass(this.widgetEventPrefix),this.m_calloutPlaceholder.css({top:"0px",left:"0px",width:"0px",height:"0px"}),this.m_placeholder.append(this.m_calloutPlaceholder),this.element.append(this.m_scrollPanel),this._mouseInit(this.m_placeholder)},primitives.orgdiagram.Controller.prototype._updateLayout=function(){this.m_scrollPanelRect=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight()),this.m_scrollPanel.css(this.m_scrollPanelRect.getCSS())},primitives.orgdiagram.Controller.prototype._bind=function(){var e=this;this.m_placeholder.mousemove(function(t){e._onMouseMove(t)}).click(function(t){e._onMouseClick(t)}),"ontouchstart"in document.documentElement&&(this.m_scrollPanel[0].addEventListener("gesturestart",e.onGestureStartHandler=function(t){e.onGestureStart(t)},!1),this.m_scrollPanel[0].addEventListener("gesturechange",e.onGestureChangeHandler=function(t){e.onGestureChange(t)},!1)),this.options.onDefaultTemplateRender=function(t,n){e._onDefaultTemplateRender(t,n)},this.options.onCheckBoxTemplateRender=function(t,n){e._onCheckBoxTemplateRender(t,n)},this.options.onGroupTitleTemplateRender=function(t,n){e._onGroupTitleTemplateRender(t,n)},this.options.onButtonsTemplateRender=function(t,n){e._onButtonsTemplateRender(t,n)}},primitives.orgdiagram.Controller.prototype._unbind=function(){this.m_placeholder.unbind("mousemove"),this.m_placeholder.unbind("click"),"ontouchstart"in document.documentElement&&(this.m_scrollPanel[0].removeEventListener("gesturestart",this.onGestureStartHandler,!1),this.m_scrollPanel[0].removeEventListener("mousewheel",this.onGestureChangeHandler,!1)),this.options.onDefaultTemplateRender=null,this.options.onCheckBoxTemplateRender=null},primitives.orgdiagram.Controller.prototype.update=function(e){switch(e){case 2:this._redrawHighlight();break;case 1:this._refresh();break;default:this._redraw()}},primitives.orgdiagram.Controller.prototype._mouseCapture=function(e){return this._dragStartPosition=new primitives.common.Point(this.m_scrollPanel.scrollLeft()+e.pageX,this.m_scrollPanel.scrollTop()+e.pageY),!0},primitives.orgdiagram.Controller.prototype._mouseDrag=function(e){var t=new primitives.common.Point(e.pageX,e.pageY),n=-t.x+this._dragStartPosition.x,r=-t.y+this._dragStartPosition.y;return this.m_scrollPanel.css("visibility","hidden"),this.m_scrollPanel.scrollLeft(n).scrollTop(r),this.m_scrollPanel.css("visibility","inherit"),!1},primitives.orgdiagram.Controller.prototype._mouseStop=function(e){this._cancelMouseClick=!0},primitives.orgdiagram.Controller.prototype._onMouseMove=function(e){var t=this.m_placeholder.offset(),n=t.left,r=t.top,i=e.pageX-n,s=e.pageY-r,o,u;this._mouseStarted||(this._cancelMouseClick=!1,o=this._getTreeItemForMousePosition(i,s),"ontouchstart"in document.documentElement?this._highlightTreeItem=o:o!==null?o.itemConfig!==this.options.highlightItem&&(this._highlightTreeItem=o,u=new primitives.orgdiagram.EventArgs,u.oldContext=this.options.highlightItem,this.options.highlightItem=o.itemConfig,u.context=this.options.highlightItem,u.parentItem=this._highlightTreeItem.logicalParentId!==null?this._treeItems[this._highlightTreeItem.logicalParentId].itemConfig:null,t=this.element.offset(),u.position=(new primitives.common.Rect(o.actualPosition)).translate(n,r).translate(-t.left,-t.top),this._trigger("onHighlightChanging",e,u),u.cancel||(this._refreshHighlight(),this._trigger("onHighlightChanged",e,u))):this.options.highlightItem!==null&&(this._highlightTreeItem=null,u=new primitives.orgdiagram.EventArgs,u.oldContext=this.options.highlightItem,u.parentItem=null,this.options.highlightItem=null,u.context=this.options.highlightItem,this._trigger("onHighlightChanging",e,u),u.cancel||(this._refreshHighlight(),this._trigger("onHighlightChanged",e,u))))},primitives.orgdiagram.Controller.prototype._onMouseClick=function(e){var t=this._highlightTreeItem,n,r,i,s,o;t!==null&&(this._cancelMouseClick||(n=jQuery(e.target),n.hasClass(this.widgetEventPrefix+"button")||n.parent("."+this.widgetEventPrefix+"button").length>0?(r=n.hasClass(this.widgetEventPrefix+"button")?n:n.parent("."+this.widgetEventPrefix+"button"),i=r.data("buttonname"),s=new primitives.orgdiagram.EventArgs,s.context=t.itemConfig,s.parentItem=t.logicalParentId!==null?this._treeItems[t.logicalParentId].itemConfig:null,s.name=i,this._trigger("onButtonClick",e,s)):n.attr("name")!=="selectiontext"&&(n.attr("name")==="checkbox"?(s=new primitives.orgdiagram.EventArgs,s.context=t.itemConfig,s.parentItem=t.logicalParentId!==null?this._treeItems[t.logicalParentId].itemConfig:null,this._trigger("onSelectionChanging",e,s),o=primitives.common.indexOf(this.options.selectedItems,t.itemConfig),o>=0?this.options.selectedItems.splice(o,1):this.options.selectedItems.push(t.itemConfig),this._trigger("onSelectionChanged",e,s)):(s=new primitives.orgdiagram.EventArgs,s.context=t.itemConfig,s.parentItem=t.logicalParentId!==null?this._treeItems[t.logicalParentId].itemConfig:null,this._trigger("onMouseClick",e,s),s.cancel||t.itemConfig!==this.options.cursorItem&&(s=new primitives.orgdiagram.EventArgs,s.oldContext=this.options.cursorItem,this.options.cursorItem=t.itemConfig,s.context=this.options.cursorItem,s.parentItem=t.logicalParentId!==null?this._treeItems[t.logicalParentId].itemConfig:null,this._trigger("onCursorChanging",e,s),s.cancel||(this._refresh(),this._trigger("onCursorChanged",e,s))))))),this._cancelMouseClick=!1},primitives.orgdiagram.Controller.prototype.onGestureStart=function(e){this._scale=this.scale,e.preventDefault()},primitives.orgdiagram.Controller.prototype.onGestureChange=function(e){var t=Math.round(this._scale*e.scale*10)/10;t>this.options.maximumScale?t=this.options.maximumScale:t<this.options.minimumScale&&(t=this.options.minimumScale),this.scale=t,this._refresh(),e.preventDefault()},primitives.orgdiagram.Controller.prototype._updateScale=function(){var e="scale("+this.scale+","+this.scale+")";this.m_placeholder.css({"transform-origin":"0 0",transform:e,"-ms-transform":e,"-webkit-transform":e,"-o-transform":e,"-moz-transform":e})},primitives.orgdiagram.Controller.prototype._redraw=function(){this._clean(),this.graphics=primitives.common.createGraphics(this.options.graphicsType,this),this.options.actualGraphicsType=this.graphics.graphicsType,this.m_calloutShape=new primitives.common.Callout(this.graphics),this._readTemplates(),this._createCheckBoxTemplate(),this._createButtonsTemplate(),this._createGroupTitleTemplate(),this._refresh()},primitives.orgdiagram.Controller.prototype._refresh=function(){this._updateLayout(),this.m_scrollPanel.css({display:"none","-webkit-overflow-scrolling":"auto"}),this._updateScale(),this._setItemsIntervals(),this._readTreeItems(),this._positionTreeItems(),this.graphics.resize("placeholder",this.m_placeholderRect.width,this.m_placeholderRect.height),this.graphics.begin(),this._redrawTreeItems(),this._redrawConnectors(),this._drawHighlight(),this._hideHighlightAnnotation(),this._drawCursor(),this.graphics.end(),this.m_scrollPanel.css({display:"block"}),this._centerOnCursor(),this.m_scrollPanel.css({"-webkit-overflow-scrolling":"touch"})},primitives.orgdiagram.Controller.prototype._setItemsIntervals=function(){this._itemsInterval[1]=this.options.normalItemsInterval,this._itemsInterval[2]=this.options.dotItemsInterval,this._itemsInterval[3]=this.options.lineItemsInterval,this._itemsInterval[4]=this.options.lineItemsInterval},primitives.orgdiagram.Controller.prototype._setTransform=function(){switch(this.options.orientationType){case primitives.orgdiagram.OrientationType.Top:this.graphics.setTransform("placeholder",!1,!1,!1);break;case primitives.orgdiagram.OrientationType.Bottom:this.graphics.setTransform("placeholder",!1,!1,!0);break;case primitives.orgdiagram.OrientationType.Left:this.graphics.setTransform("placeholder",!0,!1,!1);break;case primitives.orgdiagram.OrientationType.Right:this.graphics.setTransform("placeholder",!0,!0,!1)}},primitives.orgdiagram.Controller.prototype._redrawHighlight=function(){var e,t;for(e in this._treeItems)this._treeItems.hasOwnProperty(e)&&(t=this._treeItems[e],t.itemConfig===this.options.highlightItem&&(this._highlightTreeItem=t));this._refreshHighlight()},primitives.orgdiagram.Controller.prototype._refreshHighlight=function(){this.graphics.reset("placeholder",2),this.graphics.reset("calloutplaceholder",6),this._drawHighlight(),this._drawHighlightAnnotation()},primitives.orgdiagram.Controller.prototype._drawHighlight=function(){var e,t,n,r,i,s;this._highlightTreeItem!==null&&(e=this.graphics.activate("placeholder",2),t=this._highlightTreeItem.actualPosition,n=new primitives.common.Rect(0,0,this._highlightTreeItem.actualSize.width,this._highlightTreeItem.actualSize.height),r=this._highlightTreeItem.template.highlightPadding,n.offset(r.left,r.top,r.right,r.bottom),i=new primitives.common.RenderEventArgs,i.context=this._highlightTreeItem.itemConfig,i.isCursor=this._highlightTreeItem.isCursor,i.isSelected=this._highlightTreeItem.isSelected,i.templateName=this._highlightTreeItem.template.name,s=this.graphics.template(t.x,t.y,t.width,t.height,n.x,n.y,n.width,n.height,this._highlightTreeItem.template.highlightTemplate,this._highlightTreeItem.template.highlightTemplateHashCode,this._highlightTreeItem.template.highlightTemplateRenderName,i,{"border-width":this._highlightTreeItem.template.highlightBorderWidth}))},primitives.orgdiagram.Controller.prototype._drawCursor=function(){var e,t,n,r,i,s,o;this._cursorTreeItem!==null&&(e=this.graphics.activate("placeholder",4),t=this._cursorTreeItem,n=t.actualPosition,r=new primitives.common.Rect(t.contentPosition),i=t.template.cursorPadding,r
.offset(i.left,i.top,i.right,i.bottom),s=new primitives.common.RenderEventArgs,s.context=t.itemConfig,s.isCursor=t.isCursor,s.isSelected=t.isSelected,s.templateName=t.template.name,o=this.graphics.template(n.x,n.y,n.width,n.height,r.x,r.y,r.width,r.height,t.template.cursorTemplate,t.template.cursorTemplateHashCode,t.template.cursorTemplateRenderName,s,{"border-width":t.template.cursorBorderWidth}))},primitives.orgdiagram.Controller.prototype._redrawTreeItems=function(){var e,t,n,r,i,s,o,u={},a,f,l;this.graphics.activate("placeholder",5),this._setTransform();for(o in this._treeItems)if(this._treeItems.hasOwnProperty(o)){e=this._treeItems[o],t=this._treeLevels[e.level],e.setActualPosition(t,this.options);switch(e.actualVisibility){case 1:n=new primitives.common.RenderEventArgs,n.context=e.itemConfig,n.isCursor=e.isCursor,n.isSelected=e.isSelected,n.templateName=e.template.name,r=this.graphics.template(e.actualPosition.x,e.actualPosition.y,e.actualPosition.width,e.actualPosition.height,e.contentPosition.x,e.contentPosition.y,e.contentPosition.width,e.contentPosition.height,e.template.itemTemplate,e.template.itemTemplateHashCode,e.template.itemTemplateRenderName,n,{"border-width":e.template.itemBorderWidth}),e.hasGroupTitle&&(r=this.graphics.template(e.actualPosition.x,e.actualPosition.y,e.actualPosition.width,e.actualPosition.height,2,e.contentPosition.y,this.options.groupTitlePanelSize-4,e.contentPosition.height,this._groupTitleTemplate,this._groupTitleTemplateHashCode,"onGroupTitleTemplateRender",e,null)),e.hasSelectorCheckbox&&(r=this.graphics.template(e.actualPosition.x,e.actualPosition.y,e.actualPosition.width,e.actualPosition.height,e.contentPosition.x,e.actualSize.height-(this.options.checkBoxPanelSize-4),e.contentPosition.width,this.options.checkBoxPanelSize-4,this._checkBoxTemplate,this._checkBoxTemplateHashCode,"onCheckBoxTemplateRender",e,null)),e.hasButtons&&(r=this.graphics.template(e.actualPosition.x,e.actualPosition.y,e.actualPosition.width,e.actualPosition.height,e.actualSize.width-(this.options.buttonsPanelSize-4),e.contentPosition.y,this.options.buttonsPanelSize-4,Math.max(e.contentPosition.height,e.actualSize.height-e.contentPosition.y),this._buttonsTemplate,this._buttonsTemplateHashCode,"onButtonsTemplateRender",e,null));break;case 2:i=e.itemConfig.itemTitleColor,i==null&&(i="#000080"),u.hasOwnProperty(i)||(u[i]=[]),a=u[i],a.push(new primitives.common.DotSegment(e.actualPosition.horizontalCenter(),e.actualPosition.verticalCenter(),e.actualPosition.width/2))}}this.graphics.activate("placeholder",3);for(i in u)u.hasOwnProperty(i)&&(a=u[i],s={fillColor:i,opacity:1},this.graphics.polyline(a,s))},primitives.orgdiagram.Controller.prototype._redrawConnectors=function(){var e=this.graphics.activate("placeholder",1),t=this._visualRootItem,n,r,i,s,o;this._treeItems.hasOwnProperty(t)&&(n=this._treeItems[t],r=this._treeLevels[n.level],i=[],this._redrawConnector(e.hasGraphics,i,n,r),s={borderColor:this.options.linesColor,lineWidth:this.options.linesWidth},o=this.graphics.polyline(i,s))},primitives.orgdiagram.Controller.prototype._redrawConnector=function(e,t,n,r){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;if(n.visualChildren.length>0){i=n.actualVisibility===4&&n.id===this._visualRootItem,i||(s=new primitives.common.Point(n.actualPosition.horizontalCenter(),n.actualPosition.bottom()),o=new primitives.common.Point(n.actualPosition.horizontalCenter(),r.connectorShift),t.push(new primitives.common.MoveSegment(s)),t.push(new primitives.common.LineSegment(o))),u=null,a=null,f=[],l=n.visualChildren;for(p=0;p<l.length;p+=1){c=this._treeItems[l[p]],h=this._treeLevels[c.level];switch(c.connectorPlacement){case 7:s=new primitives.common.Point(c.actualPosition.x,c.actualPosition.verticalCenter()),d=this._treeItems[h.treeItems[c.levelPosition-1]],o=new primitives.common.Point(d.actualPosition.right(),c.actualPosition.verticalCenter()),t.push(new primitives.common.MoveSegment(s)),t.push(new primitives.common.LineSegment(o));break;case 3:s=new primitives.common.Point(c.actualPosition.right(),c.actualPosition.verticalCenter()),v=this._treeItems[h.treeItems[c.levelPosition+1]],o=new primitives.common.Point(v.actualPosition.x,c.actualPosition.verticalCenter()),t.push(new primitives.common.MoveSegment(s)),t.push(new primitives.common.LineSegment(o));break;case 1:if(!i){s=new primitives.common.Point(c.actualPosition.horizontalCenter(),r.connectorShift),o=new primitives.common.Point(c.actualPosition.horizontalCenter(),c.actualPosition.top()),g=e?c.actualVisibility:1;switch(g){case 1:case 4:f.length>0&&(m=this._drawAngularConnectors(t,null,r.connectorShift,f),u===null&&(u=m)),t.push(new primitives.common.MoveSegment(s)),t.push(new primitives.common.LineSegment(o)),u===null?u=s:a=s;break;case 2:case 3:switch(this.options.connectorType){case 1:case 2:f.push(o);break;case 0:t.push(new primitives.common.MoveSegment(s)),t.push(new primitives.common.LineSegment(o)),u===null?u=s:a=s}}}}this._redrawConnector(e,t,c,h)}i||(f.length>0&&(a=this._drawAngularConnectors(t,l.length===f.length?n.actualPosition.horizontalCenter():null,r.connectorShift,f)),u!==null&&a!==null&&(y=n.actualPosition.horizontalCenter(),y<u.x?u.x=y:y>a.x&&(a.x=y),u!==a&&(t.push(new primitives.common.MoveSegment(u)),t.push(new primitives.common.LineSegment(a)))))}},primitives.orgdiagram.Controller.prototype._drawAngularConnectors=function(e,t,n,r){var i=null,s,o;if(r.length>0){i=new primitives.common.Point(t!==null?t:(r[0].x+r[r.length-1].x)/2,n);for(s=0;s<r.length;s+=1){e.push(new primitives.common.MoveSegment(i));switch(this.options.connectorType){case 1:e.push(new primitives.common.LineSegment(r[s]));break;case 2:o=new primitives.common.Rect(i,r[s]),i.x>o.x?e.push(new primitives.common.CubicArcSegment(o.right(),o.verticalCenter(),o.x,o.verticalCenter(),o.x,o.bottom())):e.push(new primitives.common.CubicArcSegment(o.x,o.verticalCenter(),o.right(),o.verticalCenter(),o.right(),o.bottom()))}}}return r.length=0,i},primitives.orgdiagram.Controller.prototype._centerOnCursor=function(){var e;this._cursorTreeItem!==null&&(e=this.graphics.activate("placeholder",5),e.transformPoint(this._cursorTreeItem.actualPosition.horizontalCenter()*this.scale,this._cursorTreeItem.actualPosition.verticalCenter()*this.scale,this,function(e,t){this.m_scrollPanel.scrollLeft(e-this.m_scrollPanelRect.horizontalCenter()),this.m_scrollPanel.scrollTop(t-this.m_scrollPanelRect.verticalCenter())}))},primitives.orgdiagram.Controller.prototype._setOption=function(e,t){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(e){case"disabled":var n=jQuery([]);t?(n.filter(".ui-state-focus").blur(),n.removeClass("ui-state-hover"),n.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(n.propAttr("disabled",!1),this.element.removeClass("ui-disabled"));break;default:}},primitives.orgdiagram.Controller.prototype._getTreeItemForMousePosition=function(e,t){var n=null,r,i,s,o,u,a,f,l,c,h=this.graphics.activate("placeholder",5);return e/=this.scale,t/=this.scale,h.transformPointBack(e,t,this,function(e,t){for(r=0,i=this._treeLevels.length;r<i;r+=1){o=this._treeLevels[r];if(t>o.topConnectorShift&&t<=o.connectorShift){u=null,a=null;for(l=0,s=o.treeItems.length;l<s;l+=1){f=this._treeItems[o.treeItems[l]];switch(f.actualVisibility){case 1:if(f.actualPosition.contains(e,t)){n=f;return};case 2:case 3:c=Math.abs(f.actualPosition.horizontalCenter()-e);if(a===null||c<a)a=c,u=f;break;case 4:}}n=u;return}}return}),n},primitives.orgdiagram.Controller.prototype._drawHighlightAnnotation=function(){var e=primitives.common,t,n,r,i,s,o,u,a,f;if(this._highlightTreeItem!==null)switch(this._highlightTreeItem.actualVisibility){case 2:case 3:case 1:n=this._highlightTreeItem,r=new e.Rect(this.m_scrollPanel.scrollLeft(),this.m_scrollPanel.scrollTop(),Math.min(this.m_scrollPanelRect.width-25,this.m_placeholderRect.width),Math.min(this.m_scrollPanelRect.height-25,this.m_placeholderRect.height)),t=this.graphics.activate("placeholder",5),t.transformPoint(n.actualPosition.horizontalCenter(),n.actualPosition.verticalCenter(),this,function(l,c){s=new e.Point(l,c),this._highlightTreeItem.actualVisibility!=1||!r.contains(l,c)?(o=this._getAnnotationPosition(s,r,n.template.itemSize),i=new e.Rect(o),i.addRect(s.x,s.y),i.offset(50),f=i.getCSS(),f.display="inherit",f.visibility="inherit",this.m_calloutPlaceholder.css(f),s.x-=i.x,s.y-=i.y,o.x-=i.x,o.y-=i.y,u=new e.RenderEventArgs,u.context=n.itemConfig,u.isCursor=n.isCursor,u.isSelected=n.isSelected,u.templateName=n.template.name,this.graphics.resize("calloutplaceholder",i.width,i.height),t=this.graphics.activate("calloutplaceholder",6),a=this.graphics.template(o.x,o.y,o.width,o.height,0,0,o.width,o.height,n.template.itemTemplate,n.template.itemTemplateHashCode,n.template.itemTemplateRenderName,u,null),this.pointerPlacement=0,this.m_calloutShape.cornerRadius=this.options.calloutCornerRadius,this.m_calloutShape.offset=this.options.calloutOffset,this.m_calloutShape.opacity=this.options.calloutOpacity,this.m_calloutShape.lineWidth=this.options.calloutLineWidth,this.m_calloutShape.pointerWidth=this.options.calloutPointerWidth,this.m_calloutShape.borderColor=this.options.calloutBorderColor,this.m_calloutShape.fillColor=this.options.calloutfillColor,this.m_calloutShape.draw(s,o)):this.m_calloutPlaceholder.css({display:"none",visibility:"hidden"})});break;case 4:this.m_calloutPlaceholder.css({display:"none",visibility:"hidden"})}},primitives.orgdiagram.Controller.prototype._hideHighlightAnnotation=function(){this.m_calloutPlaceholder.css({display:"none",visibility:"hidden"})},primitives.orgdiagram.Controller.prototype._getAnnotationPosition=function(e,t,n){var r=new primitives.common.Rect(e.x,e.y,n.width,n.height);return e.y>t.bottom()-t.height/4?(r.y-=n.height/2,e.x<t.horizontalCenter()?r.x+=n.width/4:r.x-=n.width/4+n.width):(r.y+=n.height/4,r.x-=n.width/2),r.x<t.x?r.x=t.x+5:r.right()>t.right()&&(r.x-=r.right()-t.right()+5),r.y<t.y?r.y=t.y+5:r.bottom()>t.bottom()&&(r.y-=r.bottom()-t.bottom()+5),r},primitives.orgdiagram.Controller.prototype._positionTreeItems=function(){var e=new primitives.common.Rect(0,0,(this.m_scrollPanelRect.width-25)/this.scale,(this.m_scrollPanelRect.height-25)/this.scale),t=new primitives.common.Rect(0,0,0,0),n,r,i,s,o,u,a,f;switch(this.options.orientationType){case primitives.orgdiagram.OrientationType.Left:case primitives.orgdiagram.OrientationType.Right:e.invert()}if(this._treeLevels.length>0){switch(this.options.pageFitMode){case 0:n=[new primitives.orgdiagram.LevelVisibility(0,1)],t=this._setTreeLevelsVisibilityAndPositionTreeItems(n,0);break;default:n=[new primitives.orgdiagram.LevelVisibility(0,1)],r=[];switch(this.options.minimalVisibility){case 1:break;case 2:r.push(2);break;case 0:case 3:case 4:r.push(2),r.push(3)}for(i=this._treeLevels.length-1;i>=0;i-=1)for(s=0;s<r.length;s+=1)n.push(new primitives.orgdiagram.LevelVisibility(i,r[s]));o=this._setTreeLevelsVisibilityAndPositionTreeItems(n,n.length-1),o.addRect(e),o.offset(0,0,5,5),u=null,a=null,f=null,t=this._setTreeLevelsVisibilityAndPositionTreeItems(n,0);if(!this._checkDiagramSize(t,o)){u=0,t=this._setTreeLevelsVisibilityAndPositionTreeItems(n,n.length-1);if(this._checkDiagramSize(t,o)){a=n.length-1,f=a;while(a-u>1)f=Math.floor((a+u)/2),t=this._setTreeLevelsVisibilityAndPositionTreeItems(n,f),this._checkDiagramSize(t,o)?a=f:u=f;a!==f&&(t=this._setTreeLevelsVisibilityAndPositionTreeItems(n,a))}}}t.width<e.width&&(this._stretchToWidth(t.width,e.width),t.width=e.width),t.height<e.height&&(t.height=e.height);switch(this.options.orientationType){case primitives.orgdiagram.OrientationType.Left:case primitives.orgdiagram.OrientationType.Right:t.invert()}this.m_placeholder.css(t.getCSS()),this.m_placeholderRect=new primitives.common.Rect(t)}},primitives.orgdiagram.Controller.prototype._checkDiagramSize=function(e,t){var n=!1;switch(this.options.pageFitMode){case 1:t.width>=e.width&&(n=!0);break;case 2:t.height>=e.height&&(n=!0);break;case 3:t.height>=e.height&&t.width>=e.width&&(n=!0)}return n},primitives.orgdiagram.Controller.prototype._setTreeLevelsVisibilityAndPositionTreeItems=function(e,t){var n,r;for(n=0;n<this._treeLevels.length;n+=1)this._treeLevels[n].currentvisibility=1;for(n=0;n<=t;n+=1)r=e[n],this._treeLevels[r.level].currentvisibility=r.currentvisibility;return this._recalcLevelsDepth(),this._shiftLevels(),this._setOffsets(),new primitives.common.Rect(0,0,this._getDiagramWidth(),this._getDiagramHeight())},primitives.orgdiagram.Controller.prototype._getDiagramHeight=function(){return this._treeLevels[this._treeLevels.length-1].connectorShift},primitives.orgdiagram.Controller.prototype._getDiagramWidth=function(){var e=0,t,n;for(t=0,n=this._treeLevels.length;t<n;t+=1)e=Math.max(e,this._treeLevels[t].currentOffset);return e+=this.options.normalItemsInterval,e},primitives.orgdiagram.Controller.prototype._setOffsets=function(){var e,t;for(e=0,t=this._treeLevels.length;e<t;e+=1)this._treeLevels[e].currentOffset=0;this._treeItems[this._visualRootItem]!==undefined&&this._setOffset(this._treeItems[this._visualRootItem])},primitives.orgdiagram.Controller.prototype._setOffset=function(e){var t=this._treeLevels[e.level],n=this._itemsInterval[e.visibility===0?t.currentvisibility:e.visibility]/2,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w=t.currentOffset>0?n*e.relationDegree*this.options.cousinsIntervalMultiplier:0;e.leftPadding=n+w,e.rightPadding=n,e.offset=t.currentOffset+e.leftPadding,t.currentOffset=e.offset+e.actualSize.width+e.rightPadding;if(e.visualChildren.length>0){for(r=0,i=e.visualChildren.length;r<i;r+=1)this._setOffset(this._treeItems[e.visualChildren[r]]);s=this._getChildrenOffset(e);if(s>0)this._offsetItemChildren(e,s);else if(s<0){s=-s,this._offsetItem(e,s),o=null,u={},f=null,l=this._getParentItem(e);if(l!==null){for(r=l.visualChildren.length-1;r>=0;r-=1){c=l.visualChildren[r];if(c===e)o=[];else if(o!==null){a=this._getGapBetweenSiblings(c,e),u[c.id]=a;if(!(a>0)){f=c;break}o.splice(0,0,c)}}if(o.length>0){h=null;if(f!==null){p=[f],p=p.concat(o),p.push(e),h=[[f]];for(r=1,i=p.length;r<i;r+=1)d=p[r-1],v=p[r],d.connectorPlacement===3||v.connectorPlacement===7?h[h.length-1].push(v):h.push([v])}else h=[o.slice(0)],h[h.length-1].push(e);if(h.length>0){o=h[h.length-1];for(r=o.length-2;r>=0;r-=1)b=o[r],a=u[b.id],s=Math.min(a,s),this._offsetItem(b,s),this._offsetItemChildren(b,s)}g=s/(h.length-1);for(m=h.length-2;m>0;m-=1){y=h[m];for(r=y.length-1;r>=0;r-=1)b=y[r],a=u[b.id],s=Math.min(m*g,Math.min(a,s)),this._offsetItem(b,s),this._offsetItemChildren(b,s)}}}}}},primitives.orgdiagram.Controller.prototype._getGapBetweenSiblings=function(e,t){var n=null,r=this._getRightMargins(e),i=this._getLeftMargins(t),s=Math.min(r.length,i.length),o,u;for(o=0;o<s;o+=1){u=i[o]-r[o],n=n!==null?Math.min(n,u):u;if(u<=0)break}return Math.floor(n)},primitives.orgdiagram.Controller.prototype._getRightMargins=function(e){var t=[],n,r,i,s;n=this._rightMargins[e],n===undefined&&(n=[]),n=n.slice(),n.splice(0,0,e.id);for(r=0,i=n.length;r<i;r+=1)s=this._treeItems[n[r]],t[r]=s.offset+s.actualSize.width+s.rightPadding;return t},primitives.orgdiagram.Controller.prototype._getLeftMargins=function(e){var t=[],n,r,i,s;n=this._leftMargins[e],n===undefined&&(n=[]),n=n.slice(),n.splice(0,0,e.id);for(r=0,i=n.length;r<i;r+=1)s=this._treeItems[n[r]],t[r]=s.offset-s.leftPadding;return t},primitives.orgdiagram.Controller.prototype._getChildrenOffset=function(e){var t=e.offset+e.actualSize.width/2,n=null,r,i,s,o,u,a;if(e.visualAggregatorId===null){r=e.visualChildren,i=null;for(o=0,u=r.length;o<u;o+=1){i=this._treeItems[r[o]];if(i.connectorPlacement===1)break}s=null;for(o=r.length-1;o>=0;o-=1){s=this._treeItems[r[o]];if(s.connectorPlacement===1)break}switch(this.options.horizontalAlignment){case 1:n=i.offset+i.actualSize.width/2;break;case 2:n=s.offset+s.actualSize.width/2;break;case 0:n=(i.offset+s.offset+s.actualSize.width)/2}}else a=this._treeItems[e.visualAggregatorId],n=a.offset+a.actualSize.width/2;return t-n},primitives.orgdiagram.Controller.prototype._getParentItem=function(e){var t=null;return e!==null&&e.visualParentId!==null&&(t=this._treeItems[e.visualParentId]),t},primitives.orgdiagram.Controller.prototype._offsetItem=function(e,t){e.offset+=t;var n=this._treeLevels[e.level];n.currentOffset=Math.max(n.currentOffset,e.offset+e.actualSize.width)},primitives.orgdiagram.Controller.prototype._offsetItemChildren=function(e,t){var n=e.visualChildren,r,i,s,o;if(n.length>0){r=null;for(s=0,o=n.length;s<o;s+=1)r=this._treeItems[n[s]],r.offset+=t,this._offsetItemChildren(r,t);i=this._treeLevels[r.level],i.currentOffset=Math.max(i.currentOffset,r.offset+r.actualSize.width)}},primitives.orgdiagram.Controller.prototype._stretchToWidth=function(e,t){var n,r;switch(this.options.horizontalAlignment){case 1:n=0;break;case 2:n=t-e;break;case 0:n=(t-e)/2}if(n>0)for(r in this._treeItems)this._treeItems.hasOwnProperty(r)&&(this._treeItems[r].offset+=n)},primitives.orgdiagram.Controller.prototype._recalcLevelsDepth=function(){var e,t,n,r,i;for(e=0,t=this._treeLevels.length;e<t;e+=1)r=this._treeLevels[e],r.shift=0,r.depth=0,r.actualVisibility=4;for(i in this._treeItems)this._treeItems.hasOwnProperty(i)&&(n=this._treeItems[i],r=this._treeLevels[n.level],n.setActualSize(r,this.options),r.depth=Math.max(r.depth,n.actualSize.height),r.actualVisibility=Math.min(r.actualVisibility,n.actualVisibility))},primitives.orgdiagram.Controller.prototype._shiftLevels=function(){var e=this.options.lineLevelShift,t,n,r,i;for(t=0,n=this._treeLevels.length;t<n;t+=1)r=this._treeLevels[t],r.shift=e,i=this._getLevelShift(r.actualVisibility),r.connectorShift=r.shift+r.depth+i/2,r.topConnectorShift=r.shift-i/2,e+=r.depth+i},primitives.orgdiagram.Controller.prototype._getLevelShift=function(e){var t=0;switch(e){case 1:t=this.options.normalLevelShift;break;case 2:t=this.options.dotLevelShift;break;case 3:case 4:t=this.options.lineLevelShift}return t},primitives.orgdiagram.Controller.prototype._readTemplates=function(){var e,t,n,r;this._templates={},r=new primitives.orgdiagram.Template(new primitives.orgdiagram.TemplateConfig),r.name=this.widgetEventPrefix+"Template",r.createDefaultTemplates(this.options),this._templates[r.name]=r;for(e=0;e<this.options.templates.length;e+=1)t=this.options.templates[e],n=new primitives.orgdiagram.Template(t),n.createDefaultTemplates(this.options),this._templates[n.name]=n},primitives.orgdiagram.Controller.prototype._onDefaultTemplateRender=function(e,t){var n=t.context,r=primitives.common.highestContrast(n.itemTitleColor,this.options.itemTitleSecondFontColor,this.options.itemTitleFirstFontColor);t.element.find("[name=titleBackground]").css({background:n.itemTitleColor}),t.element.find("[name=photo]").attr({src:n.image,alt:n.title}),t.element.find("[name=title]").css({color:r}).text(n.title),t.element.find("[name=description]").text(n.description)},primitives.orgdiagram.Controller.prototype._createCheckBoxTemplate=function(){var e=jQuery("<div></div>");e.addClass("bp-item bp-selectioncheckbox-frame"),e.append(jQuery('<label><nobr><input type="checkbox" name="checkbox" class="bp-selectioncheckbox" />&nbsp;<span name="selectiontext" class="bp-selectiontext">'+this.options.selectCheckBoxLabel+"</span></nobr></label>")),this._checkBoxTemplate=e.wrap("<div>").parent().html(),this._checkBoxTemplateHashCode=primitives.common.hashCode(this._checkBoxTemplate)},primitives.orgdiagram.Controller.prototype._onCheckBoxTemplateRender=function(e,t){var n=t.element.find("[name=checkbox]");n.prop("checked",t.isSelected)},primitives.orgdiagram.Controller.prototype._createGroupTitleTemplate=function(){var e=jQuery("<div></div>");e.addClass("bp-item bp-corner-all bp-grouptitle-frame"),this._groupTitleTemplate=e.wrap("<div>").parent().html(),this._groupTitleTemplateHashCode=primitives.common.hashCode(this._groupTitleTemplate)},primitives.orgdiagram.Controller.prototype._onGroupTitleTemplateRender=function(e,t){var n=new primitives.text.Config;n.orientation=2,n.horizontalAlignment=0,n.verticalAlignment=1,n.text=t.itemConfig.groupTitle,n.fontSize="12px",n.color=primitives.common.highestContrast(t.itemConfig.groupTitleColor,this.options.itemTitleSecondFontColor,this.options.itemTitleFirstFontColor),n.fontFamily="Verdana";switch(t.renderingMode){case 0:t.element.bpText(n);break;case 1:t.element.bpText("option",n),t.element.bpText("update")}primitives.common.css(t.element,{background:t.itemConfig.groupTitleColor})},primitives.orgdiagram.Controller.prototype._createButtonsTemplate=function(){var e=jQuery("<ul></ul>");e.css({position:"absolute"}).addClass("ui-widget ui-helper-clearfix"),this._buttonsTemplate=e.wrap("<div>").parent().html(),this._buttonsTemplateHashCode=primitives.common.hashCode(this._buttonsTemplate)},primitives.orgdiagram.Controller.prototype._onButtonsTemplateRender=function(e,t){var n=0,r=10,i,s,o;switch(t.renderingMode){case 0:for(o=0;o<this.options.buttons.length;o+=1)i=this.options.buttons[o],s=jQuery('<li data-buttonname="'+i.name+'"></li>').css({position:"absolute",top:n+"px",left:"0px",width:i.size.width+"px",height:i.size.height+"px",padding:"3px"}).addClass(this.widgetEventPrefix+"button"),t.element.append(s),s.button({icons:{primary:i.icon},text:i.text,label:i.label}),n+=r+i.size.height;break;case 1:}},primitives.orgdiagram.Controller.prototype._readTreeItems=function(){var e;this._cursorTreeItem=null,this._highlightTreeItem=null,this._selectedTreeItems.length=0,this._defaultTemplate=null,this._defaultTemplate=this._templates[this.options.defaultTemplateName],this._defaultTemplate===undefined&&(this._defaultTemplate=this._templates[this.widgetEventPrefix+"Template"]),this._treeItemCounter=0,this._treeItems={},this._treeLevels=[],this._leftMargins={},this._rightMargins={},this._visualRootItem=0;if(this.options.rootItem!==null){e=this._getNewTreeItem({itemConfig:this.options.rootItem});switch(e.itemConfig.itemType){case 2:case 5:case 1:case 4:e.actualItemType=0;break;default:e.actualItemType=e.itemConfig.itemType}e.visibility=e.actualItemType===3||!e.itemConfig.isVisible?4:0,this._createVisualTree(e),this._readVisualTree(this._treeItems[this._visualRootItem],0),this._showSelectedItems(),this._showCursorNeigbours()}},primitives.orgdiagram.Controller.prototype._getNewTreeItem=function(e){var t=new primitives.orgdiagram.TreeItem(this._treeItemCounter),n;for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return this._treeItemCounter+=1,this._treeItems[t.id]=t,t},primitives.orgdiagram.Controller.prototype._createVisualTree=function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;o=[],s=e.itemConfig.items.slice(0);for(f=0,l=s.length;f<l;f+=1){n=s[f];if(this._hasVisibleChildren(n)){t=this._getNewTreeItem({itemConfig:n,logicalParentId:e.id,visualParentId:e.id,actualItemType:n.itemType}),o.push(t),this._getFirstLogicalVisibleParent(e).logicalChildren.push(t),t.visibility=t.actualItemType===3||!t.itemConfig.isVisible?4:0;switch(t.actualItemType){case 5:t=this._createNewVisualParent(t);case 2:e.visualParentId===null&&this._createNewVisualRoot(e),r=this._treeItems[e.visualParentId];switch(e.connectorPlacement){case 1:switch(n.adviserPlacementType){case 2:u=this._findLeftSiblingIndex(r.visualChildren,e),r.visualChildren.splice(u+1,0,t),t.connectorPlacement=3;break;default:a=this._findRightSiblingIndex(r.visualChildren,e),r.visualChildren.splice(a,0,t),t.connectorPlacement=7}break;case 3:u=this._findLeftSiblingIndex(r.visualChildren,e),r.visualChildren.splice(u+1,0,t),t.connectorPlacement=3;break;case 7:a=this._findRightSiblingIndex(r.visualChildren,e),r.visualChildren.splice(a,0,t),t.connectorPlacement=7}t.visualParentId=e.visualParentId;break;case 4:t=this._createNewVisualParent(t);case 1:e.visualAggregatorId===null&&this._createNewVisualAggregator(e);switch(n.adviserPlacementType){case 2:e.visualChildren.splice(0,0,t),t.connectorPlacement=3;break;default:e.visualChildren.push(t),t.connectorPlacement=7}t.visualParentId=e.id;break;case 0:case 3:r=e,e.visualAggregatorId!==null&&(r=this._treeItems[e.visualAggregatorId]),r.visualChildren.push(t),t.visualParentId=r.id}}}m=[],y=[],this._layoutChildren(e,m,y);for(f=0,l=o.length;f<l;f+=1)this._createVisualTree(o[f]);if(e.visualAggregatorId!==null){i=this._treeItems[e.visualAggregatorId];if(i.visualChildren.length>0){p=this._getAssitantsDepth(e);if(p>1)for(f=0;f<p-1;f+=1)i=this._createNewVisualAggregator(i)}}if(e.visualChildren.length>0){p=this._getAdvisersDepth(e);if(p>1){i=e;for(f=0;f<p-1;f+=1)i=this._createNewVisualAggregator(i)}}d=[];for(f=0,l=y.length;f<l;f+=1){b=y[f],d[f]=0;for(c=0,h=b.length;c<h;c+=1)d[f]=Math.max(d[f],this._getItemDepth(b[c]))}for(f=0,l=d.length;f<l;f+=1){v=d[f];if(v>1)for(c=0,h=m[f].length;c<h;c+=1){g=m[f][c];if(g.visualChildren.length>0){p=v;while(p>1)g=this._createNewVisualAggregator(g),p-=1}}}},primitives.orgdiagram.Controller.prototype._getFirstLogicalVisibleParent=function(e){var t=e;return e.visibility===4&&e.logicalParentId!=null&&(t=this._getFirstLogicalVisibleParent(this._treeItems[e.logicalParentId])),t},primitives.orgdiagram.Controller.prototype._createNewVisualParent=function(e){var t;return t=this._getNewTreeItem({visibility:4,visualChildren:[e]}),e.visualParentId=t.id,t},primitives.orgdiagram.Controller.prototype._hasVisibleChildren=function(e){var t=!0,n,r;if(e.itemType===3||!e.isVisible){t=!1;for(n=0,r=e.items.length;n<r;n+=1)if(this._hasVisibleChildren(e.items[n])){t=!0;break}}return t},primitives.orgdiagram.Controller.prototype._getAdvisersDepth=function(e){var t=0,n=this._getParentItem(e),r,i,s;if(n!==null){r=primitives.common.indexOf(n.visualChildren,e);for(i=r+1;i<n.visualChildren.length;i+=1){s=n.visualChildren[i];if(s.connectorPlacement!==7)break;t=Math.max(t,this._getItemDepth(s))}for(i=r-1;i>=0;i-=1){s=n.visualChildren[i];if(s.connectorPlacement!==3)break;t=Math.max(t,this._getItemDepth(s))}}return t},primitives.orgdiagram.Controller.prototype._getAssitantsDepth=function(e){var t=0,n,r;for(n=0;n<e.visualChildren.length;n+=1)r=e.visualChildren[n],r.connectorPlacement!==1&&(t=Math.max(t,this._getItemDepth(r)));return t},primitives.orgdiagram.Controller.prototype._getItemDepth=function(e){var t=0,n,r;for(n=0,r=e.visualChildren.length;n<r;n+=1)t=Math.max(t,this._getItemDepth(e.visualChildren[n]));return t+1},primitives.orgdiagram.Controller.prototype._layoutChildren=function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y=e.itemConfig.childrenPlacementType,b;switch(this.options.horizontalAlignment){case 0:case 1:b=3;break;case 2:b=2}y===0&&(this._hasLeavesOnly(e)?y=this.options.leavesPlacementType===0?3:this.options.leavesPlacementType:y=this.options.childrenPlacementType===0?2:this.options.childrenPlacementType),r=e,e.visualAggregatorId!==null&&(r=this._treeItems[e.visualAggregatorId]);switch(y){case 2:r.visualChildren.length>0&&(this._treeItems[r.visualChildren[0]].relationDegree=1);break;case 3:if(r.visualChildren.length>3){i=r.visualChildren.slice(0),r.visualChildren.length=0,c=Math.min(this.options.maximumColumnsInMatrix,Math.ceil(Math.sqrt(i.length))),h=Math.ceil(i.length/c),p=Math.ceil(c/2);for(d=0;d<p;d+=1){s=r;for(v=0;v<h;v+=1){u=this._getMatrixItem(i,d*2,v,c,h),a=this._getMatrixItem(i,d*2+1,v,c,h),t[v]===undefined&&(t[v]=[],n[v]=[]),u!==null&&(d==0&&(u.relationDegree=1),s.visualChildren.push(u),u.visualParentId=s.id,u.connectorPlacement=3,n[v].push(u));if(u!==null||a!==null)f=this._getNewTreeItem({visibility:4,visualParentId:s.id}),s.visualChildren.push(f),s.visualAggregatorId=f.id,t[v].push(f);a!==null&&(s.visualChildren.push(a),a.visualParentId=s.id,a.connectorPlacement=7,n[v].push(a)),s=f}}c>2&&(r.visualAggregatorId=null)}break;case 1:i=r.visualChildren.slice(0),r.visualChildren.length=0;for(m=0,g=i.length;m<g;m+=1){l=i[m],f=this._getNewTreeItem({visibility:4,visualParentId:r.id}),r.visualAggregatorId=f.id,l.visualParentId=r.id;switch(b){case 2:r.visualChildren.push(l),r.visualChildren.push(f),l.connectorPlacement=3;break;case 3:r.visualChildren.push(f),r.visualChildren.push(l),l.connectorPlacement=7}t[m]=[f],n[m]=[l],r=f}}},primitives.orgdiagram.Controller.prototype._getMatrixItem=function(e,t,n,r,i){var s,o=r%2>0,u;return o&&(t===r-1?t=e.length:t===r&&(t=r-1)),u=n*r+t,s=u>e.length-1?null:e[u],s},primitives.orgdiagram.Controller.prototype._hasLeavesOnly=function(e){var t=!1,n,r,i,s;if(e.itemConfig!==null){s=e.itemConfig.items,r=s.length;if(r>0){t=!0;for(n=0;n<r;n+=1){i=s[n];if(i.itemType===0||i.itemType===3)if(i.items.length>0){t=!1;break}}}}return t},primitives.orgdiagram.Controller.prototype._findLeftSiblingIndex=function(e,t){var n=null,r,i;for(i=e.length-1;i>=0;i-=1){r=e[i];if(n===null)r===t&&(n=-1);else if(r.actualItemType===0||r.actualItemType===3){n=i;break}}return n},primitives.orgdiagram.Controller.prototype._findRightSiblingIndex=function(e,t){var n=null,r,i,s;for(i=0,s=e.length;i<s;i+=1){r=e[i];if(n===null)r===t&&(n=s);else if(r.actualItemType===0||r.actualItemType===3){n=i;break}}return n},primitives.orgdiagram.Controller.prototype._createNewVisualRoot=function(e){var t=this._getNewTreeItem({visibility:4,visualParentId:null});t.visualChildren.push(e),e.visualParentId=t.id,this._visualRootItem=t.id},primitives.orgdiagram.Controller.prototype._createNewVisualAggregator=function(e){var t,n,r;t=this._getNewTreeItem({visibility:4,visualParentId:e.id,visualAggregatorId:e.visualAggregatorId}),t.visualChildren=e.visualChildren;for(n=0;n<t.visualChildren.length;n+=1)t.visualChildren[n].visualParentId=t.id;return e.visualChildren=[t],e.visualAggregatorId=t.id,t},primitives.orgdiagram.Controller.prototype._readVisualTree=function(e,t){var n=this._treeLevels[t],r,i,s,o,u;n===undefined&&(n=this._treeLevels[t]=new primitives.orgdiagram.TreeLevel(t)),n.treeItems.push(e.id),e.level=t,e.levelPosition=n.treeItems.length-1,r=e.itemConfig,r!==null&&(i=this._templates[r.templateName],e.template=i!==undefined?i:this._defaultTemplate,r===this.options.cursorItem&&(this._cursorTreeItem=e,this._cursorTreeItem.isCursor=!0),r===this.options.highlightItem&&(this._highlightTreeItem=e),primitives.common.indexOf(this.options.selectedItems,r)>=0&&this._selectedTreeItems.push(e),e.hasSelectorCheckbox=this._getSelectionVisibility(e.isCursor,r.hasSelectorCheckbox,this.options.hasSelectorCheckbox),e.hasButtons=this.options.buttons.length>0&&this._getSelectionVisibility(e.isCursor,r.hasButtons,this.options.hasButtons));for(s=0,o=e.visualChildren.length;s<o;s+=1)u=e.visualChildren[s],s===0&&this._updateLeftMargins(u,0),s===o-1&&this._updateRightMargins(u,0),this._readVisualTree(u,t+1)},primitives.orgdiagram.Controller.prototype._updateLeftMargins=function(e,t){var n=e,r;while((n=this._getParentItem(n))!==null)r=this._leftMargins[n.id],r===undefined&&(r=this._leftMargins[n.id]=[]),r[t]===undefined&&(r[t]=e.id),t+=1},primitives.orgdiagram.Controller.prototype._updateRightMargins=function(e,t){var n=e,r;while((n=this._getParentItem(n))!==null)r=this._rightMargins[n.id],r===undefined&&(r=this._rightMargins[n.id]=[]),r[t]=e.id,t+=1},primitives.orgdiagram.Controller.prototype._showSelectedItems=function(){var e,t,n;for(e=0;e<this._selectedTreeItems.length;e+=1){t=this._selectedTreeItems[e],t.isSelected=!0,t.visibility===0&&(t.visibility=1);switch(this.options.selectionPathMode){case 0:break;case 1:n=t;while(n!==undefined)n.visibility===0&&(n.visibility=1),n=this._treeItems[n.logicalParentId]}}},primitives.orgdiagram.Controller.prototype._showCursorNeigbours=function(){var e,t,n;if(this._cursorTreeItem!==null){for(e=0;e<this._cursorTreeItem.logicalChildren.length;e+=1)t=this._cursorTreeItem.logicalChildren[e],t.visibility===0&&(t.visibility=1);t=this._cursorTreeItem;while(t!==undefined)t.visibility===0&&(t.visibility=1),t=this._treeItems[t.logicalParentId];n=this._treeItems[this._cursorTreeItem.logicalParentId];if(n!=null){n=this._getFirstLogicalVisibleParent(n);for(e=0;e<n.logicalChildren.length;e+=1)t=n.logicalChildren[e],t.visibility===0&&(t.visibility=1)}}},primitives.orgdiagram.Controller.prototype._getSelectionVisibility=function(e,t,n){var r=!1;switch(t){case 0:switch(n){case 0:r=e;break;case 1:r=!0;break;case 2:r=!1}break;case 1:r=!0;break;case 2:r=!1}return r},primitives.orgdiagram.LevelVisibility=function(e,t){this.level=e,this.currentvisibility=t},primitives.orgdiagram.Template=function(e){this.widgetEventPrefix="orgdiagram",this.templateConfig=e,this.name=e.name,this.itemSize=e.itemSize,this.itemBorderWidth=e.itemBorderWidth,this.minimizedItemSize=e.minimizedItemSize,this.highlightPadding=e.highlightPadding,this.highlightBorderWidth=e.highlightBorderWidth,this.cursorPadding=e.cursorPadding,this.cursorBorderWidth=e.cursorBorderWidth,this.itemTemplate=e.itemTemplate,this.highlightTemplate=e.highlightTemplate,this.cursorTemplate=e.cursorTemplate,this.itemTemplateHashCode=null,this.itemTemplateRenderName="onItemRender",this.highlightTemplateHashCode=null
,this.highlightTemplateRenderName="onHighlightRender",this.cursorTemplateHashCode=null,this.cursorTemplateRenderName="onCursorRender",this.boxModel=jQuery.support.boxModel},primitives.orgdiagram.Template.prototype.createDefaultTemplates=function(e){primitives.common.isNullOrEmpty(this.itemTemplate)&&(this.itemTemplate=this._getDefaultItemTemplate(e),this.itemTemplateRenderName="onDefaultTemplateRender"),this.itemTemplateHashCode=primitives.common.hashCode(this.itemTemplate),primitives.common.isNullOrEmpty(this.cursorTemplate)&&(this.cursorTemplate=this._getDefaultCursorTemplate(e),this.cursorTemplateRenderName=null),this.cursorTemplateHashCode=primitives.common.hashCode(this.cursorTemplate),primitives.common.isNullOrEmpty(this.highlightTemplate)&&(this.highlightTemplate=this._getDefaultHighlightTemplate(),this.highlightTemplateRenderName=null),this.highlightTemplateHashCode=primitives.common.hashCode(this.highlightTemplate)},primitives.orgdiagram.Template.prototype._getDefaultItemTemplate=function(){var e=new primitives.common.Size(this.itemSize),t,n,r,i,s,o;return e.width-=this.boxModel?this.itemBorderWidth*2:0,e.height-=this.boxModel?this.itemBorderWidth*2:0,t=jQuery("<div></div>").css({"border-width":this.itemBorderWidth+"px"}).addClass("bp-item bp-corner-all bt-item-frame"),n=jQuery('<div name="titleBackground"></div>').css({top:"2px",left:"2px",width:e.width-4+"px",height:"18px"}).addClass("bp-item bp-corner-all bp-title-frame"),t.append(n),r=jQuery('<div name="title"></div>').css({top:"1px",left:"4px",width:e.width-4-8+"px",height:"16px"}).addClass("bp-item bp-title"),n.append(r),i=jQuery("<div></div>").css({top:"24px",left:"2px",width:"50px",height:"60px"}).addClass("bp-item bp-photo-frame"),t.append(i),s=jQuery('<img name="photo" alt=""></img>').css({width:"50px",height:"60px"}),i.append(s),o=jQuery('<div name="description"></div>').css({top:"24px",left:"56px",width:e.width-4-56+"px",height:"74px"}).addClass("bp-item bp-description"),t.append(o),t.wrap("<div>").parent().html()},primitives.orgdiagram.Template.prototype._getDefaultCursorTemplate=function(e){var t=jQuery("<div></div>").css({width:this.itemSize.width+this.cursorPadding.left+this.cursorPadding.right+"px",height:this.itemSize.height+this.cursorPadding.top+this.cursorPadding.bottom+"px","border-width":this.cursorBorderWidth+"px"}).addClass("bp-item bp-corner-all bp-cursor-frame");return t.wrap("<div>").parent().html()},primitives.orgdiagram.Template.prototype._getDefaultHighlightTemplate=function(){var e=jQuery("<div></div>").css({"border-width":this.highlightBorderWidth+"px"}).addClass("bp-item bp-corner-all bp-highlight-frame");return e.wrap("<div>").parent().html()},primitives.orgdiagram.TreeItem=function(e){this.id=e,this.itemConfig=null,this.logicalParentId=null,this.visualParentId=null,this.visualChildren=[],this.logicalChildren=[],this.visualAggregatorId=null,this.visibility=1,this.template=null,this.level=null,this.levelPosition=null,this.offset=0,this.leftPadding=0,this.rightPadding=0,this.actualVisibility=1,this.actualSize=null,this.actualPosition=null,this.contentPosition=null,this.isCursor=!1,this.isSelected=!1,this.hasSelectorCheckbox=!1,this.hasButtons=!1,this.hasGroupTitle=!1,this.actualItemType=null,this.connectorPlacement=1,this.relationDegree=0},primitives.orgdiagram.TreeItem.prototype.setActualSize=function(e,t){var n=primitives.common;this.actualVisibility=this.visibility===0?e.currentvisibility:this.visibility;switch(this.actualVisibility){case 1:this.actualSize=new n.Size(this.template.itemSize),this.contentPosition=new n.Rect(0,0,this.actualSize.width,this.actualSize.height),this.isCursor&&(this.actualSize.height+=this.template.cursorPadding.top+this.template.cursorPadding.bottom,this.actualSize.width+=this.template.cursorPadding.left+this.template.cursorPadding.right,this.contentPosition.x=this.template.cursorPadding.left,this.contentPosition.y=this.template.cursorPadding.top),this.hasSelectorCheckbox&&(this.actualSize.height+=t.checkBoxPanelSize),this.hasButtons&&(this.actualSize.width+=t.buttonsPanelSize),this.hasGroupTitle=!n.isNullOrEmpty(this.itemConfig.groupTitle),this.hasGroupTitle&&(this.actualSize.width+=t.groupTitlePanelSize,this.contentPosition.x+=t.groupTitlePanelSize);break;case 2:this.actualSize=new n.Size(this.template.minimizedItemSize);break;case 3:case 4:this.actualSize=new n.Size}switch(t.orientationType){case primitives.orgdiagram.OrientationType.Left:case primitives.orgdiagram.OrientationType.Right:this.actualSize.invert()}},primitives.orgdiagram.TreeItem.prototype.setActualPosition=function(e,t){var n=0;switch(t.verticalAlignment){case 0:n=0;break;case 1:n=(e.depth-this.actualSize.height)/2;break;case 2:n=e.depth-this.actualSize.height}this.actualPosition=new primitives.common.Rect(this.offset,e.shift+n,this.actualSize.width,this.actualSize.height);switch(t.orientationType){case primitives.orgdiagram.OrientationType.Left:case primitives.orgdiagram.OrientationType.Right:this.actualSize.invert()}},primitives.orgdiagram.TreeItem.prototype.toString=function(){return this.id},primitives.orgdiagram.TreeLevel=function(e){this.level=e,this.currentvisibility=1,this.actualVisibility=1,this.shift=0,this.depth=0,this.currentOffset=0,this.topConnectorShift=0,this.connectorShift=0,this.treeItems=[]},primitives.orgdiagram.TreeLevel.prototype.toString=function(){return this.level+"."+this.currentvisibility},function(e){e.widget("ui.orgDiagram",jQuery.ui.mouse2,new primitives.orgdiagram.Controller)}(jQuery);