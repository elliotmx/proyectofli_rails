/*
 * Chartkick.js
 * Create beautiful Javascript charts with minimal code
 * https://github.com/ankane/chartkick.js
 * v1.1.1
 * MIT License
 */
/*jslint browser: true, indent: 2, plusplus: true, vars: true */
/*global google, Highcharts, $*/
(function(){"use strict";function w(e){return Object.prototype.toString.call(e)==="[object Array]"}function E(e){return e instanceof Function}function S(e){return!E(e)&&e instanceof Object}function x(e,t){var n;for(n in t)S(t[n])||w(t[n])?(S(t[n])&&!S(e[n])&&(e[n]={}),w(t[n])&&!w(e[n])&&(e[n]=[]),x(e[n],t[n])):t[n]!==undefined&&(e[n]=t[n])}function T(e,t){var n={};return x(n,e),x(n,t),n}function N(e){var r,i,s,o,u,a,f,l,c,h,p;h=Object.prototype.toString.call(e);if(h==="[object Date]")return e;if(h!=="[object String]")return;if(s=e.match(t))return p=parseInt(s[1],10),a=parseInt(s[3],10)-1,r=parseInt(s[5],10),i=parseInt(s[7],10),u=s[9]?parseInt(s[9],10):0,c=s[11]?parseInt(s[11],10):0,o=s[12]?parseFloat(n+s[12].slice(1))*1e3:0,l=Date.UTC(p,a,r,i,u,c,o),s[13]&&s[14]&&(f=s[15]*60,s[17]&&(f+=parseInt(s[17],10)),f*=s[14]==="-"?-1:1,l-=f*60*1e3),new Date(l)}function C(e){var t,n,r;for(t=0;t<e.length;t++){r=e[t].data;for(n=0;n<r.length;n++)if(r[n][1]<0)return!0}return!1}function k(e,t,n,r,i){return function(s,o,u){var a=T({},e);return a=T(a,u||{}),o.hideLegend&&t(a),"min"in o?n(a,o.min):C(s)||n(a,0),"max"in o&&r(a,o.max),o.stacked&&i(a),a=T(a,o.library||{}),a}}function L(e,t){document.body.innerText?e.innerText=t:e.textContent=t}function A(e,t){L(e,"Error Loading Chart: "+t),e.style.color="#ff0000"}function O(e,t,n){jQuery.ajax({dataType:"json",url:t,success:n,error:function(t,n,r){var i=typeof r=="string"?r:r.message;A(e,i)}})}function M(e,t,n,r){try{r(e,t,n)}catch(i){throw A(e,i.message),i}}function _(e,t,n,r){typeof t=="string"?O(e,t,function(t,i,s){M(e,t,n,r)}):M(e,t,n,r)}function D(e){return""+e}function P(e){return parseFloat(e)}function H(e){if(typeof e!="object")if(typeof e=="number")e=new Date(e*1e3);else{var t=e.replace(/ /,"T").replace(" ","").replace("UTC","Z");e=N(t)||new Date(e)}return e}function B(e){if(!w(e)){var t=[],n;for(n in e)e.hasOwnProperty(n)&&t.push([n,e[n]]);e=t}return e}function j(e,t){return e[0].getTime()-t[0].getTime()}function q(e,t,n){var r,i,s,o,u;!w(e)||typeof e[0]!="object"||w(e[0])?(e=[{name:"Value",data:e}],t.hideLegend=!0):t.hideLegend=!1;for(r=0;r<e.length;r++){s=B(e[r].data),o=[];for(i=0;i<s.length;i++)u=s[i][0],u=n?H(u):D(u),o.push([u,P(s[i][1])]);n&&o.sort(j),e[r].data=o}return e}function R(e,t,n){v(e,q(t,n,!0),n)}function U(e,t,n){g(e,q(t,n,!1),n)}function z(e,t,n){var r=B(t),i;for(i=0;i<r.length;i++)r[i]=[D(r[i][0]),P(r[i][1])];m(e,r,n)}function W(e,t,n){y(e,q(t,n,!1),n)}function X(e,t,n){b(e,q(t,n,!0),n)}function V(e,t,n,r){typeof e=="string"&&(e=document.getElementById(e)),_(e,t,n||{},r)}var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;t=/(\d\d\d\d)(\-)?(\d\d)(\-)?(\d\d)(T)?(\d\d)(:)?(\d\d)?(:)?(\d\d)?([\.,]\d+)?($|Z|([\+\-])(\d\d)(:)?(\d\d)?)/i,n=String(1.5).charAt(1);if("Highcharts"in window)r={chart:{},xAxis:{labels:{style:{fontSize:"12px"}}},yAxis:{title:{text:null},labels:{style:{fontSize:"12px"}}},title:{text:null},credits:{enabled:!1},legend:{borderWidth:0},tooltip:{style:{fontSize:"12px"}},plotOptions:{areaspline:{},series:{marker:{}}}},i=function(e){e.legend.enabled=!1},s=function(e,t){e.yAxis.min=t},o=function(e,t){e.yAxis.max=t},u=function(e){e.plotOptions.series.stacking="normal"},a=k(r,i,s,o,u),v=function(e,t,n,r){r=r||"spline";var i={};r==="areaspline"&&(i={plotOptions:{areaspline:{stacking:"normal"},series:{marker:{enabled:!1}}}});var s=a(t,n,i),o,u,f;s.xAxis.type="datetime",s.chart.type=r,s.chart.renderTo=e.id;for(u=0;u<t.length;u++){o=t[u].data;for(f=0;f<o.length;f++)o[f][0]=o[f][0].getTime();t[u].marker={symbol:"circle"}}s.series=t,new Highcharts.Chart(s)},m=function(e,t,n){var i=T(r,n.library||{});i.chart.renderTo=e.id,i.series=[{type:"pie",name:"Value",data:t}],new Highcharts.Chart(i)},g=function(e,t,n,r){r=r||"column";var i=a(t,n),s,o,u,f,l=[];i.chart.type=r,i.chart.renderTo=e.id;for(s=0;s<t.length;s++){u=t[s];for(o=0;o<u.data.length;o++)f=u.data[o],l[f[0]]||(l[f[0]]=new Array(t.length)),l[f[0]][s]=f[1]}var c=[];for(s in l)l.hasOwnProperty(s)&&c.push(s);i.xAxis.categories=c;var h=[];for(s=0;s<t.length;s++){f=[];for(o=0;o<c.length;o++)f.push(l[c[o]][s]||0);h.push({name:t[s].name,data:f})}i.series=h,new Highcharts.Chart(i)},y=function(e,t,n){g(e,t,n,"bar")},b=function(e,t,n){v(e,t,n,"areaspline")};else if("google"in window){f=!1,google.setOnLoadCallback(function(){f=!0});var F={packages:["corechart"]},I=window.Chartkick||{};I.language&&(F.language=I.language),google.load("visualization","1.0",F),l=function(e){google.setOnLoadCallback(e),f&&e()},r={chartArea:{},fontName:"'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif",pointSize:6,legend:{textStyle:{fontSize:12,color:"#444"},alignment:"center",position:"right"},curveType:"function",hAxis:{textStyle:{color:"#666",fontSize:12},gridlines:{color:"transparent"},baselineColor:"#ccc",viewWindow:{}},vAxis:{textStyle:{color:"#666",fontSize:12},baselineColor:"#ccc",viewWindow:{}},tooltip:{textStyle:{color:"#666",fontSize:12}}},i=function(e){e.legend.position="none"},s=function(e,t){e.vAxis.viewWindow.min=t},o=function(e,t){e.vAxis.viewWindow.max=t},c=function(e,t){e.hAxis.viewWindow.min=t},h=function(e,t){e.hAxis.viewWindow.max=t},u=function(e){e.isStacked=!0},a=k(r,i,s,o,u),p=function(e,t){var n=new google.visualization.DataTable;n.addColumn(t,"");var r,i,s,o,u,a=[];for(r=0;r<e.length;r++){s=e[r],n.addColumn("number",s.name);for(i=0;i<s.data.length;i++)o=s.data[i],u=t==="datetime"?o[0].getTime():o[0],a[u]||(a[u]=new Array(e.length)),a[u][r]=P(o[1])}var f=[];for(r in a)a.hasOwnProperty(r)&&f.push([t==="datetime"?new Date(P(r)):r].concat(a[r]));return t==="datetime"&&f.sort(j),n.addRows(f),n},d=function(e){window.attachEvent?window.attachEvent("onresize",e):window.addEventListener&&window.addEventListener("resize",e,!0),e()},v=function(e,t,n){l(function(){var r=a(t,n),i=p(t,"datetime"),s=new google.visualization.LineChart(e);d(function(){s.draw(i,r)})})},m=function(e,t,n){l(function(){var i={chartArea:{top:"10%",height:"80%"}},s=T(T(r,i),n.library||{}),o=new google.visualization.DataTable;o.addColumn("string",""),o.addColumn("number","Value"),o.addRows(t);var u=new google.visualization.PieChart(e);d(function(){u.draw(o,s)})})},g=function(e,t,n){l(function(){var r=a(t,n),i=p(t,"string"),s=new google.visualization.ColumnChart(e);d(function(){s.draw(i,r)})})},y=function(e,t,n){l(function(){var s={hAxis:{gridlines:{color:"#ccc"}}},o=k(r,i,c,h,u)(t,n,s),a=p(t,"string"),f=new google.visualization.BarChart(e);d(function(){f.draw(a,o)})})},b=function(e,t,n){l(function(){var r={isStacked:!0,pointSize:0,areaOpacity:.5},i=a(t,n,r),s=p(t,"datetime"),o=new google.visualization.AreaChart(e);d(function(){o.draw(s,i)})})}}else v=m=g=y=b=function(){throw new Error("Please install Google Charts or Highcharts")};e={LineChart:function(e,t,n){V(e,t,n,R)},PieChart:function(e,t,n){V(e,t,n,z)},ColumnChart:function(e,t,n){V(e,t,n,U)},BarChart:function(e,t,n){V(e,t,n,W)},AreaChart:function(e,t,n){V(e,t,n,X)}},window.Chartkick=e})();